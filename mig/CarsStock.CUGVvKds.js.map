{"version":3,"file":"CarsStock.CUGVvKds.js","sources":["../src/components/car-stock/VinEditForm.vue","../src/components/car-stock/CarFilesUploadForm.vue","../src/components/car-stock/CarPortsEditForm.vue","../src/components/car-stock/CarMoneyEditForm.vue","../src/components/car-stock/CarWarehouseForm.vue","../src/components/car-stock/CarDocumentsForm.vue","../src/components/car-stock/CarLoadForm.vue","../src/components/car-stock/AdvancedFilter.vue","../src/components/car-stock/CarStockTable.vue","../src/components/car-stock/CarStockForm.vue","../src/components/car-stock/CarStockFilter.vue","../src/views/CarsStock.vue"],"sourcesContent":["<script setup>\nimport { ref, defineProps, defineEmits } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst newVin = ref('')\nconst loading = ref(false)\nconst error = ref(null)\n\nconst handleSubmit = async () => {\n  if (!newVin.value.trim()) {\n    error.value = 'VIN number is required'\n    return\n  }\n\n  loading.value = true\n  error.value = null\n\n  try {\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET vin = ? WHERE id = ?',\n      params: [newVin.value.trim(), props.car.id]\n    })\n\n    if (result.success) {\n      emit('save', { ...props.car, vin: newVin.value.trim() })\n      emit('close')\n    } else {\n      error.value = result.error || 'Failed to update VIN'\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  newVin.value = ''\n  emit('close')\n}\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Edit VIN Number</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <div class=\"form-group\">\n          <label for=\"current-vin\">Current VIN:</label>\n          <input \n            type=\"text\" \n            id=\"current-vin\" \n            :value=\"car.vin || 'N/A'\" \n            disabled \n            class=\"input-disabled\"\n          />\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"new-vin\">New VIN:</label>\n          <input \n            type=\"text\" \n            id=\"new-vin\" \n            v-model=\"newVin\" \n            placeholder=\"Enter new VIN number\"\n            class=\"input-field\"\n          />\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"cancel-btn\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Cancel\n        </button>\n        <button \n          class=\"save-btn\" \n          @click=\"handleSubmit\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? 'Saving...' : 'Save Changes' }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.input-field, .input-disabled {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.input-disabled {\n  background-color: #f3f4f6;\n  color: #6b7280;\n}\n\n.input-field:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n}\n\n.error-message {\n  color: #ef4444;\n  margin-bottom: 16px;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.cancel-btn, .save-btn {\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  cursor: pointer;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #f3f4f6;\n  color: #374151;\n}\n\n.save-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.cancel-btn:hover {\n  background-color: #e5e7eb;\n}\n\n.save-btn:hover {\n  background-color: #2563eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\nconst success = ref(null)\n\n// File refs\nconst documentsFile = ref(null)\nconst sellPiFile = ref(null)\nconst buyPiFile = ref(null)\n\nconst handleFileUpload = async (file, type) => {\n  if (!file) return null\n\n  const formData = new FormData()\n  formData.append('file', file)\n  formData.append('type', type)\n  formData.append('car_id', props.car.id)\n\n  try {\n    const response = await fetch('/api/upload_car_file.php', {\n      method: 'POST',\n      body: formData\n    })\n    \n    const result = await response.json()\n    if (!result.success) {\n      throw new Error(result.error || `Failed to upload ${type} file`)\n    }\n    \n    return result.path\n  } catch (err) {\n    throw new Error(`Error uploading ${type}: ${err.message}`)\n  }\n}\n\nconst handleSubmit = async () => {\n  loading.value = true\n  error.value = null\n  success.value = null\n  \n  try {\n    const updates = {}\n    \n    // Handle documents upload\n    if (documentsFile.value) {\n      const documentsPath = await handleFileUpload(documentsFile.value, 'documents')\n      if (documentsPath) updates.path_documents = documentsPath\n    }\n    \n    // Handle sell PI upload\n    if (sellPiFile.value) {\n      const sellPiPath = await handleFileUpload(sellPiFile.value, 'sell_pi')\n      if (sellPiPath) updates.sell_pi_path = sellPiPath\n    }\n    \n    // Handle buy PI upload\n    if (buyPiFile.value) {\n      const buyPiPath = await handleFileUpload(buyPiFile.value, 'buy_pi')\n      if (buyPiPath) updates.buy_pi_path = buyPiPath\n    }\n    \n    // If any files were uploaded, update the database\n    if (Object.keys(updates).length > 0) {\n      const setClause = Object.keys(updates)\n        .map(key => `${key} = ?`)\n        .join(', ')\n      \n      const result = await callApi({\n        query: `UPDATE cars_stock SET ${setClause} WHERE id = ?`,\n        params: [...Object.values(updates), props.car.id]\n      })\n\n      if (result.success) {\n        success.value = 'Files uploaded successfully'\n        emit('save', { ...props.car, ...updates })\n      } else {\n        throw new Error(result.error || 'Failed to update file paths')\n      }\n    } else {\n      success.value = 'No files selected for upload'\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred during upload'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  success.value = null\n  documentsFile.value = null\n  sellPiFile.value = null\n  buyPiFile.value = null\n  emit('close')\n}\n\nconst handleFileChange = (event, fileRef) => {\n  const file = event.target.files[0]\n  if (file && file.type !== 'application/pdf') {\n    alert('Only PDF files are allowed')\n    event.target.value = ''\n    return\n  }\n  fileRef.value = file\n}\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Upload Car Files</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <div class=\"form-group\">\n          <label for=\"documents\">Documents:</label>\n          <div class=\"file-input-container\">\n            <input \n              type=\"file\"\n              id=\"documents\"\n              accept=\".pdf\"\n              @change=\"e => handleFileChange(e, documentsFile)\"\n              class=\"file-input\"\n            />\n            <span class=\"current-file\" v-if=\"props.car.path_documents\">\n              Current: {{ props.car.path_documents.split('/').pop() }}\n            </span>\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"sell-pi\">Sell PI:</label>\n          <div class=\"file-input-container\">\n            <input \n              type=\"file\"\n              id=\"sell-pi\"\n              accept=\".pdf\"\n              @change=\"e => handleFileChange(e, sellPiFile)\"\n              class=\"file-input\"\n            />\n            <span class=\"current-file\" v-if=\"props.car.sell_pi_path\">\n              Current: {{ props.car.sell_pi_path.split('/').pop() }}\n            </span>\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"buy-pi\">Buy PI:</label>\n          <div class=\"file-input-container\">\n            <input \n              type=\"file\"\n              id=\"buy-pi\"\n              accept=\".pdf\"\n              @change=\"e => handleFileChange(e, buyPiFile)\"\n              class=\"file-input\"\n            />\n            <span class=\"current-file\" v-if=\"props.car.buy_pi_path\">\n              Current: {{ props.car.buy_pi_path.split('/').pop() }}\n            </span>\n          </div>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n        <div v-if=\"success\" class=\"success-message\">\n          {{ success }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"cancel-btn\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Cancel\n        </button>\n        <button \n          class=\"save-btn\" \n          @click=\"handleSubmit\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? 'Uploading...' : 'Upload Files' }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.file-input-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.file-input {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.current-file {\n  font-size: 12px;\n  color: #6b7280;\n}\n\n.error-message {\n  color: #ef4444;\n  margin-bottom: 16px;\n  font-size: 14px;\n}\n\n.success-message {\n  color: #10b981;\n  margin-bottom: 16px;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.cancel-btn, .save-btn {\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  cursor: pointer;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #f3f4f6;\n  color: #374151;\n}\n\n.save-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.cancel-btn:hover {\n  background-color: #e5e7eb;\n}\n\n.save-btn:hover {\n  background-color: #2563eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits, onMounted } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\n\n// Data for dropdowns\nconst loadingPorts = ref([])\nconst dischargePorts = ref([])\n\n// Selected values\nconst selectedLoadingPort = ref(props.car.id_port_loading || '')\nconst selectedDischargePort = ref(props.car.id_port_discharge || '')\n\n// Fetch ports data\nconst fetchPorts = async () => {\n  try {\n    // Fetch loading ports\n    const loadingPortsResult = await callApi({\n      query: 'SELECT id, loading_port FROM loading_ports ORDER BY loading_port',\n      params: []\n    })\n    if (loadingPortsResult.success) {\n      loadingPorts.value = loadingPortsResult.data\n    }\n\n    // Fetch discharge ports\n    const dischargePortsResult = await callApi({\n      query: 'SELECT id, discharge_port FROM discharge_ports ORDER BY discharge_port',\n      params: []\n    })\n    if (dischargePortsResult.success) {\n      dischargePorts.value = dischargePortsResult.data\n    }\n  } catch (err) {\n    error.value = 'Failed to load ports data'\n    console.error('Error fetching ports:', err)\n  }\n}\n\nconst handleSubmit = async () => {\n  if (!selectedLoadingPort.value && !selectedDischargePort.value) {\n    error.value = 'Please select at least one port to update'\n    return\n  }\n\n  loading.value = true\n  error.value = null\n\n  try {\n    const updates = []\n    const params = []\n    \n    if (selectedLoadingPort.value) {\n      updates.push('id_port_loading = ?')\n      params.push(selectedLoadingPort.value)\n    }\n    \n    if (selectedDischargePort.value) {\n      updates.push('id_port_discharge = ?')\n      params.push(selectedDischargePort.value)\n    }\n    \n    params.push(props.car.id)\n\n    const result = await callApi({\n      query: `UPDATE cars_stock SET ${updates.join(', ')} WHERE id = ?`,\n      params\n    })\n\n    if (result.success) {\n      // Find the port names for the response\n      const updatedCar = { ...props.car }\n      if (selectedLoadingPort.value) {\n        const loadingPort = loadingPorts.value.find(p => p.id === parseInt(selectedLoadingPort.value))\n        updatedCar.loading_port = loadingPort?.loading_port\n        updatedCar.id_port_loading = parseInt(selectedLoadingPort.value)\n      }\n      if (selectedDischargePort.value) {\n        const dischargePort = dischargePorts.value.find(p => p.id === parseInt(selectedDischargePort.value))\n        updatedCar.discharge_port = dischargePort?.discharge_port\n        updatedCar.id_port_discharge = parseInt(selectedDischargePort.value)\n      }\n      \n      emit('save', updatedCar)\n      emit('close')\n    } else {\n      throw new Error(result.error || 'Failed to update ports')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  selectedLoadingPort.value = props.car.id_port_loading || ''\n  selectedDischargePort.value = props.car.id_port_discharge || ''\n  emit('close')\n}\n\n// Fetch ports data when component is mounted\nonMounted(fetchPorts)\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Edit Ports</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <div class=\"form-group\">\n          <label for=\"loading-port\">Loading Port:</label>\n          <select \n            id=\"loading-port\" \n            v-model=\"selectedLoadingPort\"\n            class=\"select-field\"\n          >\n            <option value=\"\">Select Loading Port</option>\n            <option \n              v-for=\"port in loadingPorts\" \n              :key=\"port.id\" \n              :value=\"port.id\"\n            >\n              {{ port.loading_port }}\n            </option>\n          </select>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"discharge-port\">Discharge Port:</label>\n          <select \n            id=\"discharge-port\" \n            v-model=\"selectedDischargePort\"\n            class=\"select-field\"\n          >\n            <option value=\"\">Select Discharge Port</option>\n            <option \n              v-for=\"port in dischargePorts\" \n              :key=\"port.id\" \n              :value=\"port.id\"\n            >\n              {{ port.discharge_port }}\n            </option>\n          </select>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"cancel-btn\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Cancel\n        </button>\n        <button \n          class=\"save-btn\" \n          @click=\"handleSubmit\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? 'Saving...' : 'Save Changes' }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.select-field {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n  background-color: white;\n}\n\n.select-field:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n}\n\n.error-message {\n  color: #ef4444;\n  margin-bottom: 16px;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.cancel-btn, .save-btn {\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  cursor: pointer;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #f3f4f6;\n  color: #374151;\n}\n\n.save-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.cancel-btn:hover {\n  background-color: #e5e7eb;\n}\n\n.save-btn:hover {\n  background-color: #2563eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\n\n// Form fields\nconst price = ref(props.car.price_cell || '')\nconst freight = ref(props.car.freight || '')\nconst rate = ref(props.car.rate || '')\n\nconst handleSubmit = async () => {\n  // Validate inputs\n  if (price.value && isNaN(parseFloat(price.value))) {\n    error.value = 'Price must be a valid number'\n    return\n  }\n  if (freight.value && isNaN(parseFloat(freight.value))) {\n    error.value = 'Freight must be a valid number'\n    return\n  }\n  if (rate.value && isNaN(parseFloat(rate.value))) {\n    error.value = 'Rate must be a valid number'\n    return\n  }\n\n  loading.value = true\n  error.value = null\n\n  try {\n    const updates = []\n    const params = []\n    \n    if (price.value !== '') {\n      updates.push('price_cell = ?')\n      params.push(parseFloat(price.value))\n    }\n    \n    if (freight.value !== '') {\n      updates.push('freight = ?')\n      params.push(parseFloat(freight.value))\n    }\n    \n    if (rate.value !== '') {\n      updates.push('rate = ?')\n      params.push(parseFloat(rate.value))\n    }\n    \n    if (updates.length === 0) {\n      error.value = 'Please fill at least one field to update'\n      loading.value = false\n      return\n    }\n    \n    params.push(props.car.id)\n\n    const result = await callApi({\n      query: `UPDATE cars_stock SET ${updates.join(', ')} WHERE id = ?`,\n      params\n    })\n\n    if (result.success) {\n      const updatedCar = { \n        ...props.car,\n        price_cell: price.value !== '' ? parseFloat(price.value) : props.car.price_cell,\n        freight: freight.value !== '' ? parseFloat(freight.value) : props.car.freight,\n        rate: rate.value !== '' ? parseFloat(rate.value) : props.car.rate\n      }\n      emit('save', updatedCar)\n      emit('close')\n    } else {\n      throw new Error(result.error || 'Failed to update money fields')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  price.value = props.car.price_cell || ''\n  freight.value = props.car.freight || ''\n  rate.value = props.car.rate || ''\n  emit('close')\n}\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Edit Money Fields</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <div class=\"form-group\">\n          <label for=\"price\">Price:</label>\n          <div class=\"input-group\">\n            <span class=\"currency-symbol\">$</span>\n            <input \n              type=\"number\"\n              id=\"price\"\n              v-model=\"price\"\n              placeholder=\"Enter price\"\n              step=\"0.01\"\n              min=\"0\"\n              class=\"input-field\"\n            />\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"freight\">Freight:</label>\n          <div class=\"input-group\">\n            <span class=\"currency-symbol\">$</span>\n            <input \n              type=\"number\"\n              id=\"freight\"\n              v-model=\"freight\"\n              placeholder=\"Enter freight\"\n              step=\"0.01\"\n              min=\"0\"\n              class=\"input-field\"\n            />\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"rate\">Rate:</label>\n          <div class=\"input-group\">\n            <input \n              type=\"number\"\n              id=\"rate\"\n              v-model=\"rate\"\n              placeholder=\"Enter rate\"\n              step=\"0.01\"\n              min=\"0\"\n              class=\"input-field\"\n            />\n          </div>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"cancel-btn\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Cancel\n        </button>\n        <button \n          class=\"save-btn\" \n          @click=\"handleSubmit\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? 'Saving...' : 'Save Changes' }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.input-group {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.currency-symbol {\n  padding: 8px 12px;\n  background-color: #f3f4f6;\n  border: 1px solid #d1d5db;\n  border-right: none;\n  border-radius: 4px 0 0 4px;\n  color: #6b7280;\n}\n\n.input-field {\n  flex: 1;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 0 4px 4px 0;\n  font-size: 14px;\n}\n\n.input-field:not(.currency-input) {\n  border-radius: 4px;\n}\n\n.input-field:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n}\n\n.error-message {\n  color: #ef4444;\n  margin-bottom: 16px;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.cancel-btn, .save-btn {\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  cursor: pointer;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #f3f4f6;\n  color: #374151;\n}\n\n.save-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.cancel-btn:hover {\n  background-color: #e5e7eb;\n}\n\n.save-btn:hover {\n  background-color: #2563eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits, onMounted, computed } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\nconst success = ref(null)\n\n// Data for warehouse dropdown\nconst warehouses = ref([])\nconst selectedWarehouse = ref(props.car.id_warehouse || '')\n\n// Add user data\nconst user = ref(JSON.parse(localStorage.getItem('user') || 'null'))\n\n// Add permission check\nconst can_receive_car = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true // Admin\n  return user.value.permissions?.some(p => p.permission_name === 'can_receive_car')\n})\n\n// Fetch warehouses data\nconst fetchWarehouses = async () => {\n  try {\n    console.log('Fetching warehouses...')\n    const result = await callApi({\n      query: 'SELECT id, warhouse_name as name FROM warehouses ORDER BY warhouse_name',\n      params: []\n    })\n    console.log('API Response:', result)\n    \n    if (result.success) {\n      warehouses.value = result.data\n      console.log('Warehouses loaded:', warehouses.value)\n    } else {\n      console.error('API Error:', result.error)\n      throw new Error(result.error || 'Failed to fetch warehouses')\n    }\n  } catch (err) {\n    console.error('Full error details:', {\n      message: err.message,\n      stack: err.stack,\n      response: err.response\n    })\n    error.value = `Failed to load warehouses data: ${err.message}`\n  }\n}\n\nconst handleGetCar = async () => {\n  if (!can_receive_car.value) {\n    error.value = 'You do not have permission to receive cars'\n    return\n  }\n\n  if (props.car.in_wharhouse_date) {\n    return // Button should be disabled anyway\n  }\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET in_wharhouse_date = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'Car received in warehouse'\n      const updatedCar = { \n        ...props.car,\n        in_wharhouse_date: currentDate\n      }\n      // Update the local car data\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update warehouse date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleWarehouseChange = async () => {\n  if (!selectedWarehouse.value) {\n    error.value = 'Please select a warehouse'\n    return\n  }\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET id_warehouse = ? WHERE id = ?',\n      params: [selectedWarehouse.value, props.car.id]\n    })\n\n    if (result.success) {\n      const warehouse = warehouses.value.find(w => w.id === parseInt(selectedWarehouse.value))\n      const updatedCar = { \n        ...props.car,\n        id_warehouse: parseInt(selectedWarehouse.value),\n        warehouse_name: warehouse?.name\n      }\n      success.value = 'Warehouse updated successfully'\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update warehouse')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  success.value = null\n  selectedWarehouse.value = props.car.id_warehouse || ''\n  emit('close')\n}\n\n// Fetch warehouses data when component is mounted\nonMounted(fetchWarehouses)\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Warehouse Management</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <!-- Warehouse Status Section -->\n        <div class=\"status-section\">\n          <h4>Warehouse Status</h4>\n          <div class=\"status-info\">\n            <span class=\"status-label\">Current Status:</span>\n            <span :class=\"['status-value', props.car.in_wharhouse_date ? 'in-warehouse' : 'not-in-warehouse']\">\n              {{ props.car.in_wharhouse_date ? 'In Warehouse' : 'Not In Warehouse' }}\n            </span>\n          </div>\n          <div v-if=\"props.car.in_wharhouse_date\" class=\"date-info\">\n            <span class=\"date-label\">Received Date:</span>\n            <span class=\"date-value\">{{ new Date(props.car.in_wharhouse_date).toLocaleDateString() }}</span>\n          </div>\n        </div>\n\n        <!-- Warehouse Selection Section -->\n        <div class=\"form-group\">\n          <label for=\"warehouse\">Warehouse:</label>\n          <select \n            id=\"warehouse\" \n            v-model=\"selectedWarehouse\"\n            class=\"select-field\"\n            :disabled=\"loading\"\n          >\n            <option value=\"\">Select Warehouse</option>\n            <option \n              v-for=\"warehouse in warehouses\" \n              :key=\"warehouse.id\" \n              :value=\"warehouse.id\"\n            >\n              {{ warehouse.name }}\n            </option>\n          </select>\n          <button \n            class=\"update-warehouse-btn\" \n            @click=\"handleWarehouseChange\"\n            :disabled=\"loading || !selectedWarehouse\"\n          >\n            Update Warehouse\n          </button>\n        </div>\n\n        <!-- Get Car Button -->\n        <div class=\"get-car-section\">\n          <button \n            class=\"get-car-btn\" \n            @click=\"handleGetCar\"\n            :disabled=\"loading || !!props.car.in_wharhouse_date || !can_receive_car\"\n            :class=\"{ \n              'disabled': !!props.car.in_wharhouse_date || !can_receive_car \n            }\"\n          >\n            {{ loading ? 'Processing...' : 'We Get Car' }}\n          </button>\n          <div v-if=\"!can_receive_car && !props.car.in_wharhouse_date\" class=\"permission-notice\">\n            You need permission to receive cars\n          </div>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n        <div v-if=\"success\" class=\"success-message\">\n          {{ success }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"close-btn-secondary\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Close\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.status-section {\n  margin-bottom: 24px;\n  padding: 16px;\n  background-color: #f9fafb;\n  border-radius: 6px;\n}\n\n.status-section h4 {\n  margin: 0 0 12px 0;\n  color: #374151;\n  font-size: 1.1rem;\n}\n\n.status-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n}\n\n.status-label, .date-label {\n  font-weight: 500;\n  color: #6b7280;\n}\n\n.status-value {\n  font-weight: 600;\n}\n\n.in-warehouse {\n  color: #059669;\n}\n\n.not-in-warehouse {\n  color: #dc2626;\n}\n\n.date-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.date-value {\n  color: #374151;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.select-field {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n  margin-bottom: 12px;\n}\n\n.update-warehouse-btn {\n  width: 100%;\n  padding: 8px 16px;\n  background-color: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.update-warehouse-btn:hover {\n  background-color: #2563eb;\n}\n\n.get-car-section {\n  margin-top: 24px;\n}\n\n.get-car-btn {\n  width: 100%;\n  padding: 12px 24px;\n  background-color: #059669;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 16px;\n  font-weight: 500;\n  transition: background-color 0.2s;\n}\n\n.get-car-btn:hover:not(:disabled) {\n  background-color: #047857;\n}\n\n.get-car-btn.disabled {\n  background-color: #9ca3af;\n  cursor: not-allowed;\n}\n\n.error-message {\n  color: #ef4444;\n  margin: 16px 0;\n  font-size: 14px;\n}\n\n.success-message {\n  color: #10b981;\n  margin: 16px 0;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 20px;\n}\n\n.close-btn-secondary {\n  padding: 8px 16px;\n  background-color: #f3f4f6;\n  color: #374151;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.close-btn-secondary:hover {\n  background-color: #e5e7eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n\n.permission-notice {\n  color: #dc2626;\n  font-size: 0.875rem;\n  margin-top: 0.5rem;\n  text-align: center;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits, computed } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\nconst success = ref(null)\n\n// Form field for export license\nconst exportLicenseRef = ref(props.car.export_lisence_ref || '')\n\n// Handle BL received\nconst handleGetBL = async () => {\n  if (props.car.date_get_bl) return\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET date_get_bl = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'BL received date updated'\n      const updatedCar = { \n        ...props.car,\n        date_get_bl: currentDate\n      }\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update BL received date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\n// Handle freight payment\nconst handleFreightPaid = async () => {\n  if (props.car.date_pay_freight) return\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET date_pay_freight = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'Freight payment date updated'\n      const updatedCar = { \n        ...props.car,\n        date_pay_freight: currentDate\n      }\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update freight payment date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\n// Handle documents received from supplier\nconst handleDocsFromSupplier = async () => {\n  if (props.car.date_get_documents_from_supp) return\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET date_get_documents_from_supp = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'Documents from supplier date updated'\n      const updatedCar = { \n        ...props.car,\n        date_get_documents_from_supp: currentDate\n      }\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update documents from supplier date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\n// Handle documents sent to client\nconst handleDocsSentToClient = async () => {\n  if (props.car.date_send_documents) return\n\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET date_send_documents = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'Documents sent to client date updated'\n      const updatedCar = { \n        ...props.car,\n        date_send_documents: currentDate\n      }\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update documents sent date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\n// Handle export license update\nconst handleExportLicenseUpdate = async () => {\n  loading.value = true\n  error.value = null\n  success.value = null\n\n  try {\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET export_lisence_ref = ? WHERE id = ?',\n      params: [exportLicenseRef.value, props.car.id]\n    })\n\n    if (result.success) {\n      success.value = 'Export license reference updated'\n      const updatedCar = { \n        ...props.car,\n        export_lisence_ref: exportLicenseRef.value\n      }\n      Object.assign(props.car, updatedCar)\n      emit('save', updatedCar)\n    } else {\n      throw new Error(result.error || 'Failed to update export license reference')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  success.value = null\n  exportLicenseRef.value = props.car.export_lisence_ref || ''\n  emit('close')\n}\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Car Documents Management</h3>\n        <button class=\"close-btn\" @click=\"closeModal\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <!-- Document Status Grid -->\n        <div class=\"document-grid\">\n          <!-- BL Section -->\n          <div class=\"document-section\">\n            <h4>Bill of Lading (BL)</h4>\n            <div class=\"status-info\">\n              <span class=\"status-label\">Status:</span>\n              <span :class=\"['status-value', props.car.date_get_bl ? 'received' : 'pending']\">\n                {{ props.car.date_get_bl ? 'Received' : 'Pending' }}\n              </span>\n            </div>\n            <div v-if=\"props.car.date_get_bl\" class=\"date-info\">\n              <span class=\"date-label\">Received Date:</span>\n              <span class=\"date-value\">{{ new Date(props.car.date_get_bl).toLocaleDateString() }}</span>\n            </div>\n            <button \n              class=\"action-btn get-bl-btn\" \n              @click=\"handleGetBL\"\n              :disabled=\"loading || !!props.car.date_get_bl\"\n              :class=\"{ 'disabled': !!props.car.date_get_bl }\"\n            >\n              {{ loading ? 'Processing...' : 'We Get BL' }}\n            </button>\n          </div>\n\n          <!-- Freight Payment Section -->\n          <div class=\"document-section\">\n            <h4>Freight Payment</h4>\n            <div class=\"status-info\">\n              <span class=\"status-label\">Status:</span>\n              <span :class=\"['status-value', props.car.date_pay_freight ? 'paid' : 'pending']\">\n                {{ props.car.date_pay_freight ? 'Paid' : 'Pending' }}\n              </span>\n            </div>\n            <div v-if=\"props.car.date_pay_freight\" class=\"date-info\">\n              <span class=\"date-label\">Payment Date:</span>\n              <span class=\"date-value\">{{ new Date(props.car.date_pay_freight).toLocaleDateString() }}</span>\n            </div>\n            <button \n              class=\"action-btn freight-btn\" \n              @click=\"handleFreightPaid\"\n              :disabled=\"loading || !!props.car.date_pay_freight\"\n              :class=\"{ 'disabled': !!props.car.date_pay_freight }\"\n            >\n              {{ loading ? 'Processing...' : 'Freight Paid' }}\n            </button>\n          </div>\n\n          <!-- Supplier Documents Section -->\n          <div class=\"document-section\">\n            <h4>Supplier Documents</h4>\n            <div class=\"status-info\">\n              <span class=\"status-label\">Status:</span>\n              <span :class=\"['status-value', props.car.date_get_documents_from_supp ? 'received' : 'pending']\">\n                {{ props.car.date_get_documents_from_supp ? 'Received' : 'Pending' }}\n              </span>\n            </div>\n            <div v-if=\"props.car.date_get_documents_from_supp\" class=\"date-info\">\n              <span class=\"date-label\">Received Date:</span>\n              <span class=\"date-value\">{{ new Date(props.car.date_get_documents_from_supp).toLocaleDateString() }}</span>\n            </div>\n            <button \n              class=\"action-btn supplier-docs-btn\" \n              @click=\"handleDocsFromSupplier\"\n              :disabled=\"loading || !!props.car.date_get_documents_from_supp\"\n              :class=\"{ 'disabled': !!props.car.date_get_documents_from_supp }\"\n            >\n              {{ loading ? 'Processing...' : 'We Get Docs from Supplier' }}\n            </button>\n          </div>\n\n          <!-- Client Documents Section -->\n          <div class=\"document-section\">\n            <h4>Client Documents</h4>\n            <div class=\"status-info\">\n              <span class=\"status-label\">Status:</span>\n              <span :class=\"['status-value', props.car.date_send_documents ? 'sent' : 'pending']\">\n                {{ props.car.date_send_documents ? 'Sent' : 'Pending' }}\n              </span>\n            </div>\n            <div v-if=\"props.car.date_send_documents\" class=\"date-info\">\n              <span class=\"date-label\">Sent Date:</span>\n              <span class=\"date-value\">{{ new Date(props.car.date_send_documents).toLocaleDateString() }}</span>\n            </div>\n            <button \n              class=\"action-btn client-docs-btn\" \n              @click=\"handleDocsSentToClient\"\n              :disabled=\"loading || !!props.car.date_send_documents\"\n              :class=\"{ 'disabled': !!props.car.date_send_documents }\"\n            >\n              {{ loading ? 'Processing...' : 'Documents Sent to Client' }}\n            </button>\n          </div>\n        </div>\n\n        <!-- Export License Section -->\n        <div class=\"export-license-section\">\n          <h4>Export License</h4>\n          <div class=\"form-group\">\n            <label for=\"export-license\">Reference Number:</label>\n            <div class=\"input-group\">\n              <input \n                type=\"text\"\n                id=\"export-license\"\n                v-model=\"exportLicenseRef\"\n                placeholder=\"Enter export license reference\"\n                class=\"input-field\"\n                :disabled=\"loading\"\n              />\n              <button \n                class=\"update-btn\" \n                @click=\"handleExportLicenseUpdate\"\n                :disabled=\"loading\"\n              >\n                Update\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n        <div v-if=\"success\" class=\"success-message\">\n          {{ success }}\n        </div>\n      </div>\n\n      <div class=\"modal-footer\">\n        <button \n          class=\"close-btn-secondary\" \n          @click=\"closeModal\"\n          :disabled=\"loading\"\n        >\n          Close\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 800px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.document-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 20px;\n  margin-bottom: 24px;\n}\n\n.document-section {\n  background-color: #f9fafb;\n  padding: 16px;\n  border-radius: 6px;\n}\n\n.document-section h4 {\n  margin: 0 0 12px 0;\n  color: #374151;\n  font-size: 1.1rem;\n}\n\n.status-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n}\n\n.status-label, .date-label {\n  font-weight: 500;\n  color: #6b7280;\n}\n\n.status-value {\n  font-weight: 600;\n}\n\n.received, .paid, .sent {\n  color: #059669;\n}\n\n.pending {\n  color: #dc2626;\n}\n\n.date-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 12px;\n}\n\n.date-value {\n  color: #374151;\n}\n\n.action-btn {\n  width: 100%;\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  transition: background-color 0.2s;\n}\n\n.get-bl-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.get-bl-btn:hover:not(:disabled) {\n  background-color: #2563eb;\n}\n\n.freight-btn {\n  background-color: #059669;\n  color: white;\n}\n\n.freight-btn:hover:not(:disabled) {\n  background-color: #047857;\n}\n\n.supplier-docs-btn {\n  background-color: #8b5cf6;\n  color: white;\n}\n\n.supplier-docs-btn:hover:not(:disabled) {\n  background-color: #7c3aed;\n}\n\n.client-docs-btn {\n  background-color: #f59e0b;\n  color: white;\n}\n\n.client-docs-btn:hover:not(:disabled) {\n  background-color: #d97706;\n}\n\n.action-btn.disabled {\n  background-color: #9ca3af;\n  cursor: not-allowed;\n}\n\n.export-license-section {\n  background-color: #f9fafb;\n  padding: 16px;\n  border-radius: 6px;\n  margin-top: 20px;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.input-group {\n  display: flex;\n  gap: 8px;\n}\n\n.input-field {\n  flex: 1;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.update-btn {\n  padding: 8px 16px;\n  background-color: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.update-btn:hover:not(:disabled) {\n  background-color: #2563eb;\n}\n\n.error-message {\n  color: #ef4444;\n  margin: 16px 0;\n  font-size: 14px;\n}\n\n.success-message {\n  color: #10b981;\n  margin: 16px 0;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 20px;\n}\n\n.close-btn-secondary {\n  padding: 8px 16px;\n  background-color: #f3f4f6;\n  color: #374151;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.close-btn-secondary:hover {\n  background-color: #e5e7eb;\n}\n\nbutton:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  car: {\n    type: Object,\n    required: true\n  },\n  show: {\n    type: Boolean,\n    default: false\n  }\n})\n\nconst emit = defineEmits(['close', 'save'])\nconst { callApi } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\nconst success = ref(false)\n\nconst handleLoad = async () => {\n  if (props.car.date_loding) return\n\n  loading.value = true\n  error.value = null\n\n  try {\n    const currentDate = new Date().toISOString().split('T')[0]\n    const result = await callApi({\n      query: 'UPDATE cars_stock SET date_loding = ? WHERE id = ?',\n      params: [currentDate, props.car.id]\n    })\n\n    if (result.success) {\n      const updatedCar = { \n        ...props.car,\n        date_loding: currentDate\n      }\n      Object.assign(props.car, updatedCar)\n      success.value = true\n      setTimeout(() => {\n        emit('save', updatedCar)\n        emit('close')\n      }, 2000) // Close after animation plays\n    } else {\n      throw new Error(result.error || 'Failed to update loading date')\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeModal = () => {\n  error.value = null\n  success.value = false\n  emit('close')\n}\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h3>Car Loading</h3>\n        <button class=\"close-btn\" @click=\"closeModal\" v-if=\"!success\">&times;</button>\n      </div>\n\n      <div class=\"modal-body\">\n        <div v-if=\"!success\" class=\"loading-status\">\n          <h4>Loading Status</h4>\n          <div class=\"status-info\">\n            <span class=\"status-label\">Current Status:</span>\n            <span :class=\"['status-value', props.car.date_loding ? 'loaded' : 'pending']\">\n              {{ props.car.date_loding ? 'Loaded' : 'Pending' }}\n            </span>\n          </div>\n          <div v-if=\"props.car.date_loding\" class=\"date-info\">\n            <span class=\"date-label\">Loading Date:</span>\n            <span class=\"date-value\">{{ new Date(props.car.date_loding).toLocaleDateString() }}</span>\n          </div>\n          <button \n            class=\"action-btn load-btn\" \n            @click=\"handleLoad\"\n            :disabled=\"loading || !!props.car.date_loding\"\n            :class=\"{ 'disabled': !!props.car.date_loding }\"\n          >\n            {{ loading ? 'Processing...' : 'Load Car' }}\n          </button>\n        </div>\n\n        <div v-if=\"success\" class=\"success-animation\">\n          <div class=\"checkmark-circle\">\n            <div class=\"checkmark\"></div>\n          </div>\n          <h2 class=\"congratulations\">Congratulations!</h2>\n          <p class=\"success-message\">Car has been successfully loaded</p>\n        </div>\n\n        <div v-if=\"error\" class=\"error-message\">\n          {{ error }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.loading-status {\n  background-color: #f9fafb;\n  padding: 16px;\n  border-radius: 6px;\n}\n\n.loading-status h4 {\n  margin: 0 0 12px 0;\n  color: #374151;\n  font-size: 1.1rem;\n}\n\n.status-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n}\n\n.status-label, .date-label {\n  font-weight: 500;\n  color: #6b7280;\n}\n\n.status-value {\n  font-weight: 600;\n}\n\n.loaded {\n  color: #059669;\n}\n\n.pending {\n  color: #dc2626;\n}\n\n.date-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 12px;\n}\n\n.date-value {\n  color: #374151;\n}\n\n.action-btn {\n  width: 100%;\n  padding: 12px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 16px;\n  font-weight: 500;\n  transition: all 0.2s;\n}\n\n.load-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.load-btn:hover:not(:disabled) {\n  background-color: #2563eb;\n  transform: translateY(-1px);\n}\n\n.load-btn:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.action-btn.disabled {\n  background-color: #9ca3af;\n  cursor: not-allowed;\n}\n\n.error-message {\n  color: #ef4444;\n  margin-top: 16px;\n  font-size: 14px;\n}\n\n/* Success Animation Styles */\n.success-animation {\n  text-align: center;\n  padding: 20px;\n}\n\n.checkmark-circle {\n  width: 100px;\n  height: 100px;\n  position: relative;\n  display: inline-block;\n  vertical-align: top;\n  margin: 20px;\n}\n\n.checkmark {\n  border-radius: 50%;\n  display: block;\n  stroke-width: 2;\n  stroke: #4CAF50;\n  stroke-miterlimit: 10;\n  box-shadow: inset 0px 0px 0px #4CAF50;\n  animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;\n  position: relative;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  width: 50px;\n  height: 50px;\n}\n\n.checkmark:before {\n  content: '';\n  border-radius: 50%;\n  display: block;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 100%;\n  height: 100%;\n  background-color: #4CAF50;\n  animation: fillCheckmark 0.4s ease-in-out 0.4s forwards;\n  opacity: 0;\n}\n\n.checkmark:after {\n  content: '';\n  display: block;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -75%) rotate(45deg);\n  width: 25px;\n  height: 50px;\n  border: solid white;\n  border-width: 0 4px 4px 0;\n  animation: checkmark 0.2s ease-in-out 0.8s forwards;\n  opacity: 0;\n}\n\n.congratulations {\n  color: #059669;\n  font-size: 24px;\n  margin: 20px 0 10px;\n  animation: slideUp 0.5s ease-out 0.7s both;\n}\n\n.success-message {\n  color: #374151;\n  font-size: 16px;\n  margin: 0;\n  animation: slideUp 0.5s ease-out 0.9s both;\n}\n\n@keyframes fillCheckmark {\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes checkmark {\n  0% {\n    opacity: 0;\n    transform: translate(-50%, -75%) rotate(45deg);\n  }\n  100% {\n    opacity: 1;\n    transform: translate(-50%, -75%) rotate(45deg);\n  }\n}\n\n@keyframes scale {\n  0%, 100% {\n    transform: none;\n  }\n  50% {\n    transform: scale3d(1.1, 1.1, 1);\n  }\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style> ","<script setup>\nimport { ref, defineProps, defineEmits, watch } from 'vue'\n\nconst props = defineProps({\n  show: Boolean,\n  initialFilters: {\n    type: Object,\n    default: () => ({})\n  }\n})\n\nconst emit = defineEmits(['update:filters', 'close'])\n\nconst filters = ref({\n  id: '',\n  car_name: '',\n  color: '',\n  vin: '',\n  loading_port: '',\n  discharge_port: '',\n  freight_min: '',\n  freight_max: '',\n  price_min: '',\n  price_max: '',\n  loading_date_from: '',\n  loading_date_to: '',\n  status: '',\n  client: '',\n  warehouse: '',\n  // New checkbox filters\n  has_bl: false,\n  freight_paid: false,\n  has_supplier_docs: false,\n  in_warehouse: false,\n  has_export_license: false,\n  documents_sent: false,\n  is_loaded: false,\n  has_vin: false,\n  ...props.initialFilters\n})\n\nconst applyFilters = () => {\n  emit('update:filters', { ...filters.value })\n}\n\nconst resetFilters = () => {\n  filters.value = {\n    id: '',\n    car_name: '',\n    color: '',\n    vin: '',\n    loading_port: '',\n    discharge_port: '',\n    freight_min: '',\n    freight_max: '',\n    price_min: '',\n    price_max: '',\n    loading_date_from: '',\n    loading_date_to: '',\n    status: '',\n    client: '',\n    warehouse: '',\n    has_bl: false,\n    freight_paid: false,\n    has_supplier_docs: false,\n    in_warehouse: false,\n    has_export_license: false,\n    documents_sent: false,\n    is_loaded: false,\n    has_vin: false\n  }\n  applyFilters()\n}\n\nwatch(() => props.initialFilters, (newFilters) => {\n  filters.value = { ...filters.value, ...newFilters }\n}, { deep: true })\n</script>\n\n<template>\n  <div v-if=\"show\" class=\"advanced-filter-overlay\">\n    <div class=\"advanced-filter-modal\">\n      <div class=\"modal-header\">\n        <h3>Advanced Filters</h3>\n        <button class=\"close-btn\" @click=\"$emit('close')\">&times;</button>\n      </div>\n\n      <div class=\"filter-content\">\n        <div class=\"filter-grid\">\n          <!-- Basic Information Section -->\n          <div class=\"filter-section\">\n            <h4>Basic Information</h4>\n            <div class=\"filter-group\">\n              <label>ID:</label>\n              <input type=\"text\" v-model=\"filters.id\" placeholder=\"Car ID\">\n            </div>\n            <div class=\"filter-group\">\n              <label>Car Name:</label>\n              <input type=\"text\" v-model=\"filters.car_name\" placeholder=\"Car name\">\n            </div>\n            <div class=\"filter-group\">\n              <label>Color:</label>\n              <input type=\"text\" v-model=\"filters.color\" placeholder=\"Color\">\n            </div>\n            <div class=\"filter-group\">\n              <label>VIN:</label>\n              <input type=\"text\" v-model=\"filters.vin\" placeholder=\"VIN number\">\n            </div>\n          </div>\n\n          <!-- Ports Section -->\n          <div class=\"filter-section\">\n            <h4>Ports</h4>\n            <div class=\"filter-group\">\n              <label>Loading Port:</label>\n              <input type=\"text\" v-model=\"filters.loading_port\" placeholder=\"Loading port\">\n            </div>\n            <div class=\"filter-group\">\n              <label>Discharge Port:</label>\n              <input type=\"text\" v-model=\"filters.discharge_port\" placeholder=\"Discharge port\">\n            </div>\n          </div>\n\n          <!-- Financial Section -->\n          <div class=\"filter-section\">\n            <h4>Financial</h4>\n            <div class=\"filter-group\">\n              <label>Freight Range:</label>\n              <div class=\"range-inputs\">\n                <input type=\"number\" v-model=\"filters.freight_min\" placeholder=\"Min\">\n                <span>to</span>\n                <input type=\"number\" v-model=\"filters.freight_max\" placeholder=\"Max\">\n              </div>\n            </div>\n            <div class=\"filter-group\">\n              <label>Price Range:</label>\n              <div class=\"range-inputs\">\n                <input type=\"number\" v-model=\"filters.price_min\" placeholder=\"Min\">\n                <span>to</span>\n                <input type=\"number\" v-model=\"filters.price_max\" placeholder=\"Max\">\n              </div>\n            </div>\n          </div>\n\n          <!-- Status Section -->\n          <div class=\"filter-section\">\n            <h4>Status</h4>\n            <div class=\"filter-group\">\n              <label>Status:</label>\n              <select v-model=\"filters.status\">\n                <option value=\"\">All</option>\n                <option value=\"available\">Available</option>\n                <option value=\"sold\">Sold</option>\n              </select>\n            </div>\n            <div class=\"filter-group\">\n              <label>Client:</label>\n              <input type=\"text\" v-model=\"filters.client\" placeholder=\"Client name\">\n            </div>\n            <div class=\"filter-group\">\n              <label>Warehouse:</label>\n              <input type=\"text\" v-model=\"filters.warehouse\" placeholder=\"Warehouse\">\n            </div>\n          </div>\n\n          <!-- Document Status Section -->\n          <div class=\"filter-section document-status\">\n            <h4>Document Status</h4>\n            <div class=\"checkbox-grid\">\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.has_bl\">\n                <span>We Got BL</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.freight_paid\">\n                <span>Freight Paid</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.has_supplier_docs\">\n                <span>Got Supplier Docs</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.in_warehouse\">\n                <span>In Warehouse</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.has_export_license\">\n                <span>Has Export License</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.documents_sent\">\n                <span>Documents Sent</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.is_loaded\">\n                <span>Car Loaded</span>\n              </label>\n              <label class=\"checkbox-label\">\n                <input type=\"checkbox\" v-model=\"filters.has_vin\">\n                <span>Has VIN</span>\n              </label>\n            </div>\n          </div>\n\n          <!-- Date Range Section -->\n          <div class=\"filter-section\">\n            <h4>Date Range</h4>\n            <div class=\"filter-group\">\n              <label>Loading Date:</label>\n              <div class=\"date-range\">\n                <input type=\"date\" v-model=\"filters.loading_date_from\" placeholder=\"From\">\n                <span>to</span>\n                <input type=\"date\" v-model=\"filters.loading_date_to\" placeholder=\"To\">\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"filter-actions\">\n          <button class=\"reset-btn\" @click=\"resetFilters\">Reset</button>\n          <button class=\"apply-btn\" @click=\"applyFilters\">Apply Filters</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.advanced-filter-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.advanced-filter-modal {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  width: 90%;\n  max-width: 1200px;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #1f2937;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6b7280;\n}\n\n.filter-content {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.filter-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 20px;\n}\n\n.filter-section {\n  background-color: #f9fafb;\n  padding: 16px;\n  border-radius: 6px;\n}\n\n.filter-section h4 {\n  margin: 0 0 12px 0;\n  color: #374151;\n  font-size: 1.1rem;\n}\n\n.filter-group {\n  margin-bottom: 12px;\n}\n\n.filter-group label {\n  display: block;\n  margin-bottom: 4px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.filter-group input,\n.filter-group select {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.range-inputs,\n.date-range {\n  display: grid;\n  grid-template-columns: 1fr auto 1fr;\n  gap: 8px;\n  align-items: center;\n}\n\n.range-inputs span,\n.date-range span {\n  color: #6b7280;\n  font-size: 14px;\n}\n\n.document-status .checkbox-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 12px;\n}\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-label input[type=\"checkbox\"] {\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n}\n\n.checkbox-label span {\n  color: #374151;\n  font-size: 14px;\n}\n\n.filter-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n  padding-top: 20px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.reset-btn,\n.apply-btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background-color 0.2s;\n}\n\n.reset-btn {\n  background-color: #f3f4f6;\n  color: #374151;\n}\n\n.reset-btn:hover {\n  background-color: #e5e7eb;\n}\n\n.apply-btn {\n  background-color: #3b82f6;\n  color: white;\n}\n\n.apply-btn:hover {\n  background-color: #2563eb;\n}\n\n@media (max-width: 768px) {\n  .filter-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .document-status .checkbox-grid {\n    grid-template-columns: 1fr;\n  }\n}\n</style> ","<script setup>\nimport { ref, onMounted, defineProps, defineEmits, computed, watch, onUnmounted } from 'vue'\nimport { useApi } from '../../composables/useApi'\nimport VinEditForm from './VinEditForm.vue'\nimport CarFilesUploadForm from './CarFilesUploadForm.vue'\nimport CarPortsEditForm from './CarPortsEditForm.vue'\nimport CarMoneyEditForm from './CarMoneyEditForm.vue'\nimport CarWarehouseForm from './CarWarehouseForm.vue'\nimport CarDocumentsForm from './CarDocumentsForm.vue'\nimport CarLoadForm from './CarLoadForm.vue'\nimport AdvancedFilter from './AdvancedFilter.vue'\n\nconst isDropdownOpen = ref({});\nconst props = defineProps({\n  cars: Array,\n  onEdit: {\n    type: Function,\n    default: () => {}\n  },\n  filters: {\n    type: Object,\n    default: () => ({\n      basic: '',\n      advanced: {\n        id: '',\n        car_name: '',\n        color: '',\n        vin: '',\n        loading_port: '',\n        discharge_port: '',\n        freight_min: '',\n        freight_max: '',\n        price_min: '',\n        price_max: '',\n        loading_date_from: '',\n        loading_date_to: '',\n        status: '',\n        client: '',\n        warehouse: '',\n        has_bl: false,\n        freight_paid: false,\n        has_supplier_docs: false,\n        in_warehouse: false,\n        has_export_license: false,\n        documents_sent: false,\n        is_loaded: false,\n        has_vin: false\n      }\n    })\n  }\n})\n\n// Add watcher for filters\nwatch(() => props.filters, (newFilters) => {\n  fetchCarsStock()\n}, { deep: true })\n\nconst user = ref(null)\nconst can_edit_cars_prop = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_cars_prop')\n})\n\nconst emit = defineEmits(['refresh'])\n\nconst { callApi, getFileUrl } = useApi()\nconst cars = ref([])\nconst loading = ref(true)\nconst error = ref(null)\n\n// Add new refs and computed properties for VIN editing\nconst showVinEditForm = ref(false)\nconst selectedCar = ref(null)\n\nconst can_edit_vin = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_vin')\n})\n\n// Add new refs and computed properties for file upload\nconst showFilesUploadForm = ref(false)\n\nconst can_upload_car_files = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_upload_car_files')\n})\n\n// Add new refs and computed properties for ports editing\nconst showPortsEditForm = ref(false)\n\nconst can_edit_cars_ports = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_cars_ports')\n})\n\n// Add new refs and computed properties for money editing\nconst showMoneyEditForm = ref(false)\n\nconst can_edit_car_money = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_car_money')\n})\n\n// Add new refs for warehouse form\nconst showWarehouseForm = ref(false)\n\n// Add new computed property for warehouse permission\nconst can_edit_warehouse = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_warehouse')\n})\n\n// Add to the data/refs section\nconst showDocumentsForm = ref(false)\nconst selectedCarForDocuments = ref(null)\n\n// Add this computed property after other permission computeds\nconst can_edit_car_documents = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_car_documents')\n})\n\n// Add new refs for load form\nconst showLoadForm = ref(false)\nconst selectedCarForLoad = ref(null)\n\n// Add new computed property for load permission\nconst can_load_car = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_load_car')\n})\n\n// Add to the data/refs section\nconst showAdvancedFilter = ref(false)\nconst advancedFilters = ref({})\n\nconst fetchCarsStock = async () => {\n  loading.value = true\n  error.value = null\n  \n  try {\n    // Build the base query\n    let query = `\n      SELECT \n        cs.id,\n        cs.vin,\n        cs.price_cell,\n        cs.date_loding,\n        cs.date_sell,\n        cs.notes,\n        cs.freight,\n        cs.path_documents,\n        cs.sell_pi_path,\n        cs.buy_pi_path,\n        cs.id_client,\n        cs.id_port_loading,\n        cs.id_port_discharge,\n        cs.id_buy_details,\n        cs.date_send_documents,\n        cs.id_sell_pi,\n        cs.id_sell,\n        cs.export_lisence_ref,\n        cs.id_warehouse,\n        cs.in_wharhouse_date,\n        cs.date_get_documents_from_supp,\n        cs.date_get_keys_from_supp,\n        cs.rate,\n        cs.date_get_bl,\n        cs.date_pay_freight,\n        c.name as client_name,\n        cn.car_name,\n        clr.color,\n        lp.loading_port,\n        dp.discharge_port,\n        bd.price_sell as buy_price,\n        w.warhouse_name as warehouse_name\n      FROM cars_stock cs\n      LEFT JOIN clients c ON cs.id_client = c.id\n      LEFT JOIN buy_details bd ON cs.id_buy_details = bd.id\n      LEFT JOIN cars_names cn ON bd.id_car_name = cn.id\n      LEFT JOIN colors clr ON bd.id_color = clr.id\n      LEFT JOIN loading_ports lp ON cs.id_port_loading = lp.id\n      LEFT JOIN discharge_ports dp ON cs.id_port_discharge = dp.id\n      LEFT JOIN warehouses w ON cs.id_warehouse = w.id\n      WHERE cs.hidden = 0\n    `\n    \n    const params = []\n    \n    // Apply filters if they exist\n    if (props.filters) {\n      // Basic filter (search across multiple fields)\n      if (props.filters.basic && props.filters.basic.trim() !== '') {\n        const searchTerm = `%${props.filters.basic.trim()}%`\n        query += `\n          AND (\n            cs.id LIKE ? OR\n            cn.car_name LIKE ? OR\n            clr.color LIKE ? OR\n            cs.vin LIKE ? OR\n            lp.loading_port LIKE ? OR\n            dp.discharge_port LIKE ? OR\n            c.name LIKE ? OR\n            w.warhouse_name LIKE ?\n          )\n        `\n        // Add the search parameter 8 times (once for each field)\n        for (let i = 0; i < 8; i++) {\n          params.push(searchTerm)\n        }\n      }\n      \n      // Advanced filters\n      if (props.filters.advanced) {\n        const adv = props.filters.advanced\n        \n        // ID filter\n        if (adv.id && adv.id.trim() !== '') {\n          query += ` AND cs.id = ?`\n          params.push(adv.id.trim())\n        }\n        \n        // Car name filter\n        if (adv.car_name && adv.car_name.trim() !== '') {\n          query += ` AND cn.car_name = ?`\n          params.push(adv.car_name.trim())\n        }\n        \n        // Color filter\n        if (adv.color && adv.color.trim() !== '') {\n          query += ` AND clr.color = ?`\n          params.push(adv.color.trim())\n        }\n        \n        // VIN filter\n        if (adv.vin && adv.vin.trim() !== '') {\n          query += ` AND cs.vin LIKE ?`\n          params.push(`%${adv.vin.trim()}%`)\n        }\n        \n        // Loading port filter\n        if (adv.loading_port && adv.loading_port.trim() !== '') {\n          query += ` AND lp.loading_port = ?`\n          params.push(adv.loading_port.trim())\n        }\n        \n        // Discharge port filter\n        if (adv.discharge_port && adv.discharge_port.trim() !== '') {\n          query += ` AND dp.discharge_port = ?`\n          params.push(adv.discharge_port.trim())\n        }\n        \n        // Freight range filter\n        if (adv.freight_min && adv.freight_min.trim() !== '') {\n          query += ` AND cs.freight >= ?`\n          params.push(parseFloat(adv.freight_min.trim()))\n        }\n        if (adv.freight_max && adv.freight_max.trim() !== '') {\n          query += ` AND cs.freight <= ?`\n          params.push(parseFloat(adv.freight_max.trim()))\n        }\n        \n        // Price range filter\n        if (adv.price_min && adv.price_min.trim() !== '') {\n          query += ` AND cs.price_cell >= ?`\n          params.push(parseFloat(adv.price_min.trim()))\n        }\n        if (adv.price_max && adv.price_max.trim() !== '') {\n          query += ` AND cs.price_cell <= ?`\n          params.push(parseFloat(adv.price_max.trim()))\n        }\n        \n        // Loading date range filter\n        if (adv.loading_date_from && adv.loading_date_from.trim() !== '') {\n          query += ` AND cs.date_loding >= ?`\n          params.push(adv.loading_date_from.trim())\n        }\n        if (adv.loading_date_to && adv.loading_date_to.trim() !== '') {\n          query += ` AND cs.date_loding <= ?`\n          params.push(adv.loading_date_to.trim())\n        }\n        \n        // Status filter (Available/Sold)\n        if (adv.status && adv.status.trim() !== '') {\n          if (adv.status === 'available') {\n            query += ` AND (cs.date_sell IS NULL AND cs.id_client IS NULL)`\n          } else if (adv.status === 'sold') {\n            query += ` AND (cs.date_sell IS NOT NULL OR cs.id_client IS NOT NULL)`\n          }\n        }\n        \n        // Client filter\n        if (adv.client && adv.client.trim() !== '') {\n          query += ` AND c.name = ?`\n          params.push(adv.client.trim())\n        }\n        \n        // Warehouse filter\n        if (adv.warehouse && adv.warehouse.trim() !== '') {\n          query += ` AND w.name = ?`\n          params.push(adv.warehouse.trim())\n        }\n        \n        // Document status filters\n        if (adv.has_bl) {\n          query += ` AND cs.date_get_bl IS NOT NULL`\n        }\n        \n        if (adv.freight_paid) {\n          query += ` AND cs.date_pay_freight IS NOT NULL`\n        }\n        \n        if (adv.has_supplier_docs) {\n          query += ` AND cs.date_get_documents_from_supp IS NOT NULL`\n        }\n        \n        if (adv.in_warehouse) {\n          query += ` AND cs.in_wharhouse_date IS NOT NULL`\n        }\n        \n        if (adv.has_export_license) {\n          query += ` AND cs.export_lisence_ref IS NOT NULL AND cs.export_lisence_ref != ''`\n        }\n        \n        if (adv.documents_sent) {\n          query += ` AND cs.date_send_documents IS NOT NULL`\n        }\n        \n        if (adv.is_loaded) {\n          query += ` AND cs.date_loding IS NOT NULL`\n        }\n        \n        if (adv.has_vin) {\n          query += ` AND cs.vin IS NOT NULL AND cs.vin != ''`\n        }\n      }\n    }\n    \n    // Add the ORDER BY clause\n    query += ` ORDER BY cs.id DESC`\n    \n    const result = await callApi({\n      query,\n      params\n    })\n    \n    if (result.success) {\n      cars.value = result.data\n    } else {\n      error.value = result.error || 'Failed to fetch cars stock'\n    }\n  } catch (err) {\n    error.value = err.message || 'An error occurred'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleEdit = (car) => {\n  props.onEdit(car)\n}\n\nconst toggleDropdown = (carId, event) => {\n  // Prevent the click from bubbling up to the document\n  event.stopPropagation()\n  \n  // Close all other dropdowns\n  const newDropdownState = {}\n  newDropdownState[carId] = !isDropdownOpen.value[carId]\n  isDropdownOpen.value = newDropdownState\n}\n\n// Add new methods for VIN editing\nconst handleVINAction = (car) => {\n  if (!can_edit_vin.value) {\n    alert('You do not have permission to edit VIN numbers')\n    return\n  }\n  selectedCar.value = car\n  showVinEditForm.value = true\n  isDropdownOpen.value[car.id] = false\n}\n\nconst handleVinSave = (updatedCar) => {\n  // Update the car in the local array\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new methods for file upload\nconst handleFilesAction = (car) => {\n  if (!can_upload_car_files.value) {\n    alert('You do not have permission to upload car files')\n    return\n  }\n  selectedCar.value = car\n  showFilesUploadForm.value = true\n  isDropdownOpen.value[car.id] = false\n}\n\nconst handleFilesSave = (updatedCar) => {\n  // Update the car in the local array\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new methods for ports editing\nconst handlePortsAction = (car) => {\n  if (!can_edit_cars_ports.value) {\n    alert('You do not have permission to edit car ports')\n    return\n  }\n  selectedCar.value = car\n  showPortsEditForm.value = true\n  isDropdownOpen.value[car.id] = false\n}\n\nconst handlePortsSave = (updatedCar) => {\n  // Update the car in the local array\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new methods for money editing\nconst handleMoneyAction = (car) => {\n  if (!can_edit_car_money.value) {\n    alert('You do not have permission to edit car money fields')\n    return\n  }\n  selectedCar.value = car\n  showMoneyEditForm.value = true\n  isDropdownOpen.value[car.id] = false\n}\n\nconst handleMoneySave = (updatedCar) => {\n  // Update the car in the local array\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new method for warehouse action\nconst handleWarehouseAction = (car) => {\n  if (!can_edit_warehouse.value) {\n    alert('You do not have permission to manage warehouse')\n    return\n  }\n  selectedCar.value = car\n  showWarehouseForm.value = true\n  isDropdownOpen.value[car.id] = false\n}\n\nconst handleWarehouseSave = (updatedCar) => {\n  // Update the car in the local array\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new method for documents action\nconst handleDocumentsClick = async (car) => {\n  if (!can_edit_car_documents.value) {\n    alert('You do not have permission to manage car documents')\n    return\n  }\n  \n  try {\n    // Fetch the latest car data with all document fields\n    const result = await callApi({\n      query: `\n        SELECT \n          cs.id,\n          cs.date_get_bl,\n          cs.date_pay_freight,\n          cs.date_get_documents_from_supp,\n          cs.date_send_documents,\n          cs.export_lisence_ref\n        FROM cars_stock cs\n        WHERE cs.id = ?\n      `,\n      params: [car.id]\n    })\n    \n    if (result.success && result.data.length > 0) {\n      // Merge the fetched document data with the existing car data\n      selectedCarForDocuments.value = {\n        ...car,\n        ...result.data[0]\n      }\n      showDocumentsForm.value = true\n    } else {\n      throw new Error('Failed to fetch car document data')\n    }\n  } catch (err) {\n    alert(err.message || 'An error occurred while fetching car document data')\n  }\n}\n\nconst handleDocumentsClose = () => {\n  showDocumentsForm.value = false\n  selectedCarForDocuments.value = null\n}\n\nconst handleDocumentsSave = (updatedCar) => {\n  // Update the car in the table data\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add new methods for load action\nconst handleLoadClick = (car) => {\n  selectedCarForLoad.value = car\n  showLoadForm.value = true\n}\n\nconst handleLoadClose = () => {\n  showLoadForm.value = false\n  selectedCarForLoad.value = null\n}\n\nconst handleLoadSave = (updatedCar) => {\n  // Update the car in the table data\n  const index = cars.value.findIndex(c => c.id === updatedCar.id)\n  if (index !== -1) {\n    cars.value[index] = { ...cars.value[index], ...updatedCar }\n  }\n}\n\n// Add this method after other methods\nconst closeAllDropdowns = () => {\n  isDropdownOpen.value = {}\n}\n\nconst handleClickOutside = (event) => {\n  const dropdowns = document.querySelectorAll('.dropdown')\n  let clickedOutside = true\n  \n  dropdowns.forEach(dropdown => {\n    if (dropdown.contains(event.target)) {\n      clickedOutside = false\n    }\n  })\n\n  if (clickedOutside) {\n    closeAllDropdowns()\n  }\n}\n\nconst handleAdvancedFilters = (filters) => {\n  advancedFilters.value = filters\n  showAdvancedFilter.value = false\n  // Trigger the watcher by updating the filters prop\n  props.filters.advanced = filters\n}\n\nonMounted(() => {\n  const userStr = localStorage.getItem('user')\n  if (userStr) {\n    user.value = JSON.parse(userStr)\n    fetchCarsStock()\n  }\n  \n  // Add click outside listener\n  document.addEventListener('click', handleClickOutside)\n})\n\n// Add onUnmounted to clean up the event listener\nonUnmounted(() => {\n  document.removeEventListener('click', handleClickOutside)\n})\n\n// Expose the fetchCarsStock method to parent components\ndefineExpose({\n  fetchCarsStock\n})\n\n</script>\n\n<template>\n  <div class=\"cars-stock-table\">\n    <!-- Add all form components -->\n    <VinEditForm\n      v-if=\"showVinEditForm\"\n      :car=\"selectedCar\"\n      :show=\"showVinEditForm\"\n      @close=\"showVinEditForm = false\"\n      @save=\"handleVinSave\"\n    />\n    \n    <CarFilesUploadForm\n      v-if=\"showFilesUploadForm\"\n      :car=\"selectedCar\"\n      :show=\"showFilesUploadForm\"\n      @close=\"showFilesUploadForm = false\"\n      @save=\"handleFilesSave\"\n    />\n    \n    <CarPortsEditForm\n      v-if=\"showPortsEditForm\"\n      :car=\"selectedCar\"\n      :show=\"showPortsEditForm\"\n      @close=\"showPortsEditForm = false\"\n      @save=\"handlePortsSave\"\n    />\n    \n    <CarMoneyEditForm\n      v-if=\"showMoneyEditForm\"\n      :car=\"selectedCar\"\n      :show=\"showMoneyEditForm\"\n      @close=\"showMoneyEditForm = false\"\n      @save=\"handleMoneySave\"\n    />\n    \n    <CarWarehouseForm\n      v-if=\"showWarehouseForm\"\n      :car=\"selectedCar\"\n      :show=\"showWarehouseForm\"\n      @close=\"showWarehouseForm = false\"\n      @save=\"handleWarehouseSave\"\n    />\n    \n    <CarDocumentsForm\n      v-if=\"showDocumentsForm\"\n      :car=\"selectedCarForDocuments\"\n      :show=\"showDocumentsForm\"\n      @close=\"handleDocumentsClose\"\n      @save=\"handleDocumentsSave\"\n    />\n    \n    <CarLoadForm\n      v-if=\"showLoadForm\"\n      :car=\"selectedCarForLoad\"\n      :show=\"showLoadForm\"\n      @close=\"handleLoadClose\"\n      @save=\"handleLoadSave\"\n    />\n    \n    <div class=\"table-actions\">\n      <button class=\"advanced-filter-btn\" @click=\"showAdvancedFilter = true\">\n        Advanced Filters\n      </button>\n    </div>\n    \n    <AdvancedFilter\n      :show=\"showAdvancedFilter\"\n      :initial-filters=\"advancedFilters\"\n      @update:filters=\"handleAdvancedFilters\"\n      @close=\"showAdvancedFilter = false\"\n    />\n    \n    <div v-if=\"loading\" class=\"loading\">Loading...</div>\n    <div v-else-if=\"error\" class=\"error\">{{ error }}</div>\n    <div v-else-if=\"cars.length === 0\" class=\"empty-state\">No cars in stock</div>\n    \n    <div v-else class=\"table-container\">\n      <table class=\"cars-table\">\n      <thead>\n        <tr>\n          <th>ID</th>\n          <th>Car</th>\n          <th>Color</th>\n          <th>VIN</th>\n          <th>Loading Port</th>\n          <th>Discharge Port</th>\n          <th>Freight</th>\n          <th>Price Cell</th>\n          <th>Loading Date</th>\n          <th>Status</th>\n          <th>Client</th>\n          <th>Documents</th>\n          <th>Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"car in cars\" :key=\"car.id\">\n          <td>{{ car.id }}</td>\n          <td>{{ car.car_name || 'N/A' }}</td>\n          <td>{{ car.color || 'N/A' }}</td>\n          <td>{{ car.vin || 'N/A' }}</td>\n          <td>{{ car.loading_port || 'N/A' }}</td>\n          <td>{{ car.discharge_port || 'N/A' }}</td>\n          <td>{{ car.freight ? '$' + car.freight : 'N/A' }}</td>\n          <td>{{ car.price_cell ? '$' + car.price_cell : 'N/A' }}</td>\n          <td>{{ car.date_loding ? new Date(car.date_loding).toLocaleDateString() : 'N/A' }}</td>\n          <td :class=\"car.date_sell || car.client_name ? 'status-sold' : 'status-available'\">\n            {{ car.date_sell || car.client_name ? 'Sold' : 'Available' }}\n          </td>\n          <td>{{ car.client_name || 'N/A' }}</td>\n            <td class=\"documents-cell\">\n            <div class=\"document-links\">\n                <a v-if=\"car.path_documents\" \n                   :href=\"getFileUrl(car.path_documents)\" \n                   target=\"_blank\"\n                   class=\"document-link\"\n                   title=\"View Documents\">\n                  <i class=\"fas fa-file-pdf\"></i>\n                  Documents\n                </a>\n                <a v-if=\"car.sell_pi_path\" \n                   :href=\"getFileUrl(car.sell_pi_path)\" \n                   target=\"_blank\"\n                   class=\"document-link\"\n                   title=\"View Sell PI\">\n                  <i class=\"fas fa-file-invoice-dollar\"></i>\n                  Sell PI\n                </a>\n                <a v-if=\"car.buy_pi_path\" \n                   :href=\"getFileUrl(car.buy_pi_path)\" \n                   target=\"_blank\"\n                   class=\"document-link\"\n                   title=\"View Buy PI\">\n                  <i class=\"fas fa-file-invoice\"></i>\n                  Buy PI\n                </a>\n            </div>\n          </td>\n          <td>\n            <button :disabled=\"!can_edit_cars_prop\" @click=\"handleEdit(car)\" class=\"edit-btn\">Edit</button>\n            <div class=\"dropdown\">\n                <button @click=\"toggleDropdown(car.id, $event)\" class=\"dropdown-toggle\">Actions</button>\n            <ul v-if=\"isDropdownOpen[car.id]\" class=\"dropdown-menu\">\n                  <li>\n                    <button \n                      @click=\"handleVINAction(car)\"\n                      :disabled=\"!can_edit_vin\"\n                      :class=\"{ 'disabled': !can_edit_vin }\"\n                    >\n                      VIN\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handleFilesAction(car)\"\n                      :disabled=\"!can_upload_car_files\"\n                      :class=\"{ 'disabled': !can_upload_car_files }\"\n                    >\n                      Files\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handlePortsAction(car)\"\n                      :disabled=\"!can_edit_cars_ports\"\n                      :class=\"{ 'disabled': !can_edit_cars_ports }\"\n                    >\n                      Ports\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handleMoneyAction(car)\"\n                      :disabled=\"!can_edit_car_money\"\n                      :class=\"{ 'disabled': !can_edit_car_money }\"\n                    >\n                      Money\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handleWarehouseAction(car)\"\n                      :disabled=\"!can_edit_warehouse\"\n                      :class=\"{ 'disabled': !can_edit_warehouse }\"\n                    >\n                      Warehouse\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handleDocumentsClick(car)\"\n                      :disabled=\"!can_edit_car_documents\"\n                      :class=\"{ 'disabled': !can_edit_car_documents }\"\n                    >\n                      <!-- <v-icon left>mdi-file-document-edit</v-icon> -->\n                      Car Documents\n                    </button>\n                  </li>\n                  <li>\n                    <button \n                      @click=\"handleLoadClick(car)\"\n                      :disabled=\"!can_load_car\"\n                      :class=\"{ 'disabled': !can_load_car }\"\n                    >\n                      Load\n                    </button>\n                  </li>\n            </ul>\n          </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  </div>\n</template>\n\n<style scoped>\n/* Add styles for frozen header */\n.table-container {\n  position: relative;\n  max-height: calc(100vh - 250px);\n  overflow-y: auto;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n}\n\n.cars-table {\n  width: 100%;\n  border-collapse: separate;\n  border-spacing: 0;\n}\n\n.cars-table thead {\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  background-color: #f8f9fa;\n}\n\n.cars-table th {\n  padding: 12px;\n  text-align: left;\n  border-bottom: 2px solid #e5e7eb;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n.cars-table td {\n  padding: 12px;\n  border-bottom: 1px solid #e5e7eb;\n  background-color: white;\n}\n\n/* Add styles for dropdown items */\n.dropdown-menu li button.disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  color: #6b7280;\n}\n\nbutton:disabled {\n  background-color: #cccccc;\n  color: #666666;\n  cursor: not-allowed;\n}\n.cars-stock-table {\n  width: 100%;\n  overflow-x: auto;\n}\n\n.loading, .error, .empty-state {\n  padding: 20px;\n  text-align: center;\n}\n\n.error {\n  color: #ef4444;\n}\n\n.cars-table tbody tr:hover {\n  background-color: #f5f5f5;\n}\n\n.status-available {\n  color: #10b981;\n  font-weight: 500;\n}\n\n.status-sold {\n  color: #ef4444;\n  font-weight: 500;\n}\n\n.documents-cell {\n  min-width: 120px;\n}\n\n.document-links {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.document-link {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  color: #3b82f6;\n  text-decoration: none;\n  font-size: 0.85em;\n  padding: 4px 8px;\n  border-radius: 4px;\n  transition: background-color 0.2s;\n}\n\n.document-link:hover {\n  background-color: #f3f4f6;\n  text-decoration: underline;\n}\n\n.document-link i {\n  font-size: 1em;\n  color: #ef4444;\n}\n\n.edit-btn {\n  background-color: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 6px 12px;\n  cursor: pointer;\n  font-size: 0.9em;\n}\n\n.edit-btn:hover {\n  background-color: #2563eb;\n}\n\n.dropdown {\n  position: relative;\n  display: inline-block;\n}\n\n.dropdown-toggle {\n  background-color: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 4px 8px;\n  cursor: pointer;\n}\n\n.dropdown-menu {\n  position: absolute;\n  right: 0;\n  background-color: white;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  list-style: none;\n  padding: 8px 0;\n  margin: 0;\n  z-index: 1;\n  min-width: 120px;\n}\n\n.dropdown-menu li {\n  padding: 8px 16px;\n}\n\n.dropdown-menu li button {\n  background: none;\n  border: none;\n  cursor: pointer;\n  width: 100%;\n  text-align: left;\n}\n\n.dropdown-menu li button:hover {\n  background-color: #f5f5f5;\n}\n\n.table-actions {\n  margin-bottom: 16px;\n}\n\n.advanced-filter-btn {\n  padding: 8px 16px;\n  background-color: #f3f4f6;\n  color: #374151;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background-color 0.2s;\n}\n\n.advanced-filter-btn:hover {\n  background-color: #e5e7eb;\n}\n</style>","<script setup>\nimport { ref, onMounted, watch, defineProps, defineEmits, computed } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst props = defineProps({\n  carData: {\n    type: Object,\n    required: true\n  }\n})\n\nconst user = ref(null)\nconst can_edit_vin = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_vin')\n})\n\nconst can_edit_car_client_name = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_car_client_name')\n})\n\nconst can_edit_cars_sell_price = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_cars_sell_price')\n})\n\nconst can_edit_cars_sell_rate = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_cars_sell_rate')\n})\n\nconst can_edit_cars_discharge_port = computed(() => {\n  if (!user.value) return false\n  if (user.value.role_id === 1) return true\n  return user.value.permissions?.some(p => p.permission_name === 'can_edit_cars_discharge_port')\n})\n\nconst emit = defineEmits(['save', 'cancel'])\n\nconst { callApi, uploadFile, getFileUrl } = useApi()\nconst loading = ref(false)\nconst error = ref(null)\n\n// File upload refs\nconst documentsFile = ref(null)\nconst sellPiFile = ref(null)\nconst buyPiFile = ref(null)\n\n// Reference data\nconst clients = ref([])\nconst loadingPorts = ref([])\nconst dischargePorts = ref([])\nconst buyDetails = ref([])\nconst warehouses = ref([])\n\nconst formData = ref({\n  id: null,\n  notes: '',\n  id_buy_details: null,\n  date_sell: null,\n  id_client: null,\n  price_cell: null,\n  freight: null,\n  id_port_loading: null,\n  id_port_discharge: null,\n  vin: '',\n  path_documents: '',\n  date_loding: null,\n  date_send_documents: null,\n  id_sell_pi: '',\n  sell_pi_path: '',\n  buy_pi_path: '',\n  id_sell: null,\n  export_lisence_ref: '',\n  id_warehouse: null,\n  in_wharhouse_date: null,\n  date_get_documents_from_supp: null,\n  date_get_keys_from_supp: null,\n  rate: null\n})\n\n// Handle file changes\nconst handleFileChange = (event, fileType) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  switch (fileType) {\n    case 'documents':\n      documentsFile.value = file\n      break\n    case 'sellPi':\n      sellPiFile.value = file\n      break\n    case 'buyPi':\n      buyPiFile.value = file\n      break\n  }\n}\n\n// Upload a single file and return its path\nconst uploadSingleFile = async (file, folder, customFilename = '') => {\n  if (!file) return null\n  \n  try {\n    // Get original file extension\n    const originalExt = file.name.split('.').pop().toLowerCase()\n    \n    // Create a meaningful filename based on car details\n    let filename = ''\n    if (formData.value.vin) {\n      // If VIN exists, use it as the primary identifier\n      filename = `${formData.value.vin}`\n    } else if (formData.value.id) {\n      // If no VIN but ID exists, use car ID\n      filename = `car_${formData.value.id}`\n    } else {\n      // Fallback to timestamp if neither exists\n      filename = `new_car_${Date.now()}`\n    }\n    \n    // Add folder-specific prefix\n    switch (folder) {\n      case 'documents':\n        filename = `docs_${filename}`\n        break\n      case 'sell_pi':\n        filename = `sell_pi_${filename}`\n        break\n      case 'buy_pi':\n        filename = `buy_pi_${filename}`\n        break\n    }\n    \n    // Add date for versioning\n    const date = new Date()\n    const dateStr = `${date.getFullYear()}${String(date.getMonth() + 1).padStart(2, '0')}${String(date.getDate()).padStart(2, '0')}`\n    filename = `${filename}_${dateStr}.${originalExt}`\n\n    const result = await uploadFile(file, folder, filename)\n    if (result.success) {\n      return result.relativePath\n    }\n    throw new Error(result.message || 'Upload failed')\n  } catch (err) {\n    console.error(`Error uploading file to ${folder}:`, err)\n    throw err\n  }\n}\n\n// Watch for changes in carData prop\nwatch(() => props.carData, (newData) => {\n  if (newData) {\n    // Create a new object with all fields from newData\n    formData.value = { \n      ...newData,\n      // Convert rate to number if it exists, otherwise null\n      rate: newData.rate ? Number(newData.rate) : null\n    }\n    \n    // Format dates for input fields\n    const dateFields = ['date_sell', 'date_loding', 'date_send_documents', 'in_wharhouse_date', 'date_get_documents_from_supp', 'date_get_keys_from_supp']\n    \n    dateFields.forEach(field => {\n      if (formData.value[field]) {\n        const date = new Date(formData.value[field])\n        if (!isNaN(date)) {\n          formData.value[field] = date.toISOString().split('T')[0]\n        }\n      }\n    })\n  }\n}, { immediate: true })\n\nconst fetchReferenceData = async () => {\n  try {\n    // Fetch clients\n    const clientsResult = await callApi({\n      query: 'SELECT id, name FROM clients ORDER BY name ASC',\n      params: []\n    })\n    if (clientsResult.success) {\n      clients.value = clientsResult.data\n    }\n    \n    // Fetch loading ports\n    const loadingPortsResult = await callApi({\n      query: 'SELECT id, loading_port FROM loading_ports ORDER BY loading_port ASC',\n      params: []\n    })\n    if (loadingPortsResult.success) {\n      loadingPorts.value = loadingPortsResult.data\n    }\n    \n    // Fetch discharge ports\n    const dischargePortsResult = await callApi({\n      query: 'SELECT id, discharge_port FROM discharge_ports ORDER BY discharge_port ASC',\n      params: []\n    })\n    if (dischargePortsResult.success) {\n      dischargePorts.value = dischargePortsResult.data\n    }\n    \n    // Fetch buy details\n    const buyDetailsResult = await callApi({\n      query: `\n        SELECT bd.id, cn.car_name, clr.color \n        FROM buy_details bd\n        LEFT JOIN cars_names cn ON bd.id_car_name = cn.id\n        LEFT JOIN colors clr ON bd.id_color = clr.id\n        ORDER BY bd.id DESC\n      `,\n      params: []\n    })\n    if (buyDetailsResult.success) {\n      buyDetails.value = buyDetailsResult.data\n    }\n    \n    // Fetch warehouses if needed\n    const warehousesResult = await callApi({\n      query: 'SELECT id, warhouse_name as name FROM warehouses ORDER BY warhouse_name ASC',\n      params: []\n    })\n    if (warehousesResult.success) {\n      warehouses.value = warehousesResult.data\n    }\n  } catch (err) {\n    error.value = err.message || 'Failed to fetch reference data'\n  }\n}\n\nconst saveCar = async () => {\n  loading.value = true\n  error.value = null\n  \n  try {\n    // Handle file uploads first\n    if (documentsFile.value) {\n      formData.value.path_documents = await uploadSingleFile(documentsFile.value, 'documents')\n    }\n    \n    if (sellPiFile.value) {\n      formData.value.sell_pi_path = await uploadSingleFile(sellPiFile.value, 'sell_pi')\n    }\n    \n    if (buyPiFile.value) {\n      formData.value.buy_pi_path = await uploadSingleFile(buyPiFile.value, 'buy_pi')\n    }\n\n    const result = await callApi({\n      query: `\n        UPDATE cars_stock\n        SET \n          notes = ?,\n          id_buy_details = ?,\n          date_sell = ?,\n          id_client = ?,\n          price_cell = ?,\n          freight = ?,\n          id_port_loading = ?,\n          id_port_discharge = ?,\n          vin = ?,\n          path_documents = ?,\n          date_loding = ?,\n          date_send_documents = ?,\n          id_sell_pi = ?,\n          sell_pi_path = ?,\n          buy_pi_path = ?,\n          id_sell = ?,\n          export_lisence_ref = ?,\n          id_warehouse = ?,\n          in_wharhouse_date = ?,\n          date_get_documents_from_supp = ?,\n          date_get_keys_from_supp = ?,\n          rate = ?\n        WHERE id = ?\n      `,\n      params: [\n        formData.value.notes || null,\n        formData.value.id_buy_details || null,\n        formData.value.date_sell || null,\n        formData.value.id_client || null,\n        formData.value.price_cell || null,\n        formData.value.freight || null,\n        formData.value.id_port_loading || null,\n        formData.value.id_port_discharge || null,\n        formData.value.vin || null,\n        formData.value.path_documents || null,\n        formData.value.date_loding || null,\n        formData.value.date_send_documents || null,\n        formData.value.id_sell_pi || null,\n        formData.value.sell_pi_path || null,\n        formData.value.buy_pi_path || null,\n        formData.value.id_sell || null,\n        formData.value.export_lisence_ref || null,\n        formData.value.id_warehouse || null,\n        formData.value.in_wharhouse_date || null,\n        formData.value.date_get_documents_from_supp || null,\n        formData.value.date_get_keys_from_supp || null,\n        formData.value.rate || null,\n        formData.value.id\n      ]\n    })\n    \n    if (result.success) {\n      emit('save')\n    } else {\n      throw new Error(result.error || 'Failed to save car')\n    }\n  } catch (err) {\n    error.value = err.message\n    console.error('Error saving car:', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nonMounted(() => {\n  const userStr = localStorage.getItem('user')\n  if (userStr) {\n    user.value = JSON.parse(userStr)\n  }\n      fetchReferenceData()\n})\n</script>\n\n<template>\n  <div class=\"car-stock-form\">\n    <h3>{{ formData.id ? 'Edit' : 'Add' }} Car Stock</h3>\n    \n      <div class=\"form-grid\">\n        <!-- Basic Information -->\n        <div class=\"form-section\">\n          <h4>Basic Information</h4>\n          \n          <div class=\"form-group\">\n            <label for=\"vin\">VIN:</label>\n            <input :disabled=\"!can_edit_vin\" type=\"text\" id=\"vin\" v-model=\"formData.vin\">\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"id_buy_details\">Buy Details:</label>\n            <select id=\"id_buy_details\" v-model=\"formData.id_buy_details\">\n              <option value=\"\">Select Buy Details</option>\n              <option v-for=\"detail in buyDetails\" :key=\"detail.id\" :value=\"detail.id\">\n                {{ detail.car_name }} - {{ detail.color }} (ID: {{ detail.id }})\n              </option>\n            </select>\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"notes\">Notes:</label>\n            <textarea id=\"notes\" v-model=\"formData.notes\"></textarea>\n          </div>\n        </div>\n        \n        <!-- Pricing and Client -->\n        <div class=\"form-section\">\n          <h4>Pricing and Client</h4>\n          \n          <div class=\"form-group\">\n            <label for=\"price_cell\">Price Cell:</label>\n            <input :disabled=\"!can_edit_cars_sell_price\" type=\"number\" id=\"price_cell\" v-model=\"formData.price_cell\" step=\"0.01\">\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"freight\">Freight:</label>\n            <input type=\"number\" id=\"freight\" v-model=\"formData.freight\" step=\"0.01\">\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"rate\">Rate:</label>\n            <input :disabled=\"!can_edit_cars_sell_rate\" type=\"number\" id=\"rate\" v-model=\"formData.rate\" step=\"0.01\">\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"id_client\">Client:</label>\n            <select :disabled=\"!can_edit_car_client_name\" id=\"id_client\" v-model=\"formData.id_client\">\n              <option  value=\"\">Select Client</option>\n              <option v-for=\"client in clients\" :key=\"client.id\" :value=\"client.id\">\n                {{ client.name }}\n              </option>\n            </select>\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"date_sell\">Sell Date:</label>\n            <input type=\"date\" id=\"date_sell\" v-model=\"formData.date_sell\">\n          </div>\n        </div>\n        \n        <!-- Ports and Shipping -->\n        <div class=\"form-section\">\n          <h4>Ports and Shipping</h4>\n          \n          <div class=\"form-group\">\n            <label for=\"id_port_loading\">Loading Port:</label>\n            <select id=\"id_port_loading\" v-model=\"formData.id_port_loading\">\n              <option value=\"\">Select Loading Port</option>\n              <option v-for=\"port in loadingPorts\" :key=\"port.id\" :value=\"port.id\">\n                {{ port.loading_port }}\n              </option>\n            </select>\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"id_port_discharge\">Discharge Port:</label>\n            <select :disabled=\"!can_edit_cars_discharge_port\" id=\"id_port_discharge\" v-model=\"formData.id_port_discharge\">\n              <option value=\"\">Select Discharge Port</option>\n              <option v-for=\"port in dischargePorts\" :key=\"port.id\" :value=\"port.id\">\n                {{ port.discharge_port }}\n              </option>\n            </select>\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"date_loding\">Loading Date:</label>\n            <input type=\"date\" id=\"date_loding\" v-model=\"formData.date_loding\">\n          </div>\n          \n          <div class=\"form-group\">\n            <label for=\"export_lisence_ref\">Export License Ref:</label>\n            <input type=\"text\" id=\"export_lisence_ref\" v-model=\"formData.export_lisence_ref\">\n          </div>\n        </div>\n        \n      <!-- Documents Upload -->\n          <div class=\"form-group\">\n        <label>Documents:</label>\n        <div class=\"file-upload-container\">\n          <input \n            type=\"file\" \n            @change=\"handleFileChange($event, 'documents')\" \n            accept=\".pdf\"\n            class=\"file-input\"\n          />\n          <a \n            v-if=\"formData.path_documents\" \n            :href=\"getFileUrl(formData.path_documents)\"\n            target=\"_blank\" \n            class=\"current-file-link\"\n          >\n            View Current Document\n          </a>\n          </div>\n          </div>\n          \n      <!-- Sell PI Upload -->\n          <div class=\"form-group\">\n        <label>Sell PI:</label>\n        <div class=\"file-upload-container\">\n          <input \n            type=\"file\" \n            @change=\"handleFileChange($event, 'sellPi')\" \n            accept=\".pdf\"\n            class=\"file-input\"\n          />\n          <a \n            v-if=\"formData.sell_pi_path\" \n            :href=\"getFileUrl(formData.sell_pi_path)\"\n            target=\"_blank\"\n            class=\"current-file-link\"\n          >\n            View Sell PI\n          </a>\n        </div>\n          </div>\n          \n      <!-- Buy PI Upload -->\n          <div class=\"form-group\">\n        <label>Buy PI:</label>\n        <div class=\"file-upload-container\">\n          <input \n            type=\"file\" \n            @change=\"handleFileChange($event, 'buyPi')\" \n            accept=\".pdf\"\n            class=\"file-input\"\n          />\n          <a \n            v-if=\"formData.buy_pi_path\" \n            :href=\"getFileUrl(formData.buy_pi_path)\"\n            target=\"_blank\"\n            class=\"current-file-link\"\n          >\n            View Buy PI\n          </a>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"form-actions\">\n      <button \n        @click=\"saveCar\" \n        :disabled=\"loading\" \n        class=\"btn save-btn\"\n      >\n        {{ loading ? 'Saving...' : 'Save' }}\n      </button>\n      <button @click=\"$emit('cancel')\" class=\"btn cancel-btn\">Cancel</button>\n      </div>\n\n    <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\n  </div>\n</template>\n\n<style scoped>\n.car-stock-form {\n  width: 100%;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.error {\n  color: #ef4444;\n  margin-bottom: 16px;\n  padding: 8px;\n  background-color: #fee2e2;\n  border-radius: 4px;\n}\n\n.form-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n.form-section {\n  background-color: #f8f9fa;\n  padding: 16px;\n  border-radius: 8px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.form-section h4 {\n  margin-top: 0;\n  margin-bottom: 16px;\n  color: #4b5563;\n  border-bottom: 1px solid #e5e7eb;\n  padding-bottom: 8px;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 4px;\n  font-weight: 500;\n  color: #4b5563;\n}\n\n.form-group input,\n.form-group select,\n.form-group textarea {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.form-group textarea {\n  min-height: 80px;\n  resize: vertical;\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 24px;\n}\n\n.cancel-btn {\n  background-color: #f3f4f6;\n  color: #4b5563;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 8px 16px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.save-btn {\n  background-color: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 8px 16px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.save-btn:hover {\n  background-color: #2563eb;\n}\n\n.save-btn:disabled {\n  background-color: #93c5fd;\n  cursor: not-allowed;\n}\n\n.file-upload-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.file-input {\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  width: 100%;\n}\n\n.current-file-link {\n  color: #3b82f6;\n  text-decoration: none;\n  font-size: 0.9em;\n  display: inline-block;\n  padding: 4px 0;\n}\n\n.current-file-link:hover {\n  text-decoration: underline;\n}\n\n.error-message {\n  color: #ef4444;\n  margin-top: 16px;\n  font-size: 0.9em;\n}\n</style>","<script setup>\nimport { ref, defineEmits } from 'vue'\nimport { useApi } from '../../composables/useApi'\n\nconst emit = defineEmits(['filter'])\n\nconst { callApi } = useApi()\n\n// Reference data for dropdowns\nconst carNames = ref([])\nconst colors = ref([])\nconst loadingPorts = ref([])\nconst dischargePorts = ref([])\nconst clients = ref([])\nconst warehouses = ref([])\n\n// Basic filter\nconst basicFilter = ref('')\n\n// Advanced filter state\nconst showAdvancedFilter = ref(false)\nconst advancedFilters = ref({\n  id: '',\n  car_name: '',\n  color: '',\n  vin: '',\n  loading_port: '',\n  discharge_port: '',\n  freight_min: '',\n  freight_max: '',\n  price_min: '',\n  price_max: '',\n  loading_date_from: '',\n  loading_date_to: '',\n  status: '',\n  client: '',\n  warehouse: ''\n})\n\n// Fetch reference data for filter dropdowns\nconst fetchReferenceData = async () => {\n  try {\n    // Fetch car names\n    const carNamesResult = await callApi({\n      query: 'SELECT id, car_name FROM cars_names ORDER BY car_name',\n      params: []\n    })\n    if (carNamesResult.success) {\n      carNames.value = carNamesResult.data\n    }\n\n    // Fetch colors\n    const colorsResult = await callApi({\n      query: 'SELECT id, color FROM colors ORDER BY color',\n      params: []\n    })\n    if (colorsResult.success) {\n      colors.value = colorsResult.data\n    }\n\n    // Fetch loading ports\n    const loadingPortsResult = await callApi({\n      query: 'SELECT id, loading_port FROM loading_ports ORDER BY loading_port',\n      params: []\n    })\n    if (loadingPortsResult.success) {\n      loadingPorts.value = loadingPortsResult.data\n    }\n\n    // Fetch discharge ports\n    const dischargePortsResult = await callApi({\n      query: 'SELECT id, discharge_port FROM discharge_ports ORDER BY discharge_port',\n      params: []\n    })\n    if (dischargePortsResult.success) {\n      dischargePorts.value = dischargePortsResult.data\n    }\n\n    // Fetch clients\n    const clientsResult = await callApi({\n      query: 'SELECT id, name FROM clients ORDER BY name',\n      params: []\n    })\n    if (clientsResult.success) {\n      clients.value = clientsResult.data\n    }\n\n    // Fetch warehouses\n    const warehousesResult = await callApi({\n      query: 'SELECT id, name FROM warehouses ORDER BY name',\n      params: []\n    })\n    if (warehousesResult.success) {\n      warehouses.value = warehousesResult.data\n    }\n  } catch (error) {\n    console.error('Error fetching reference data:', error)\n  }\n}\n\n// Apply basic filter\nconst applyBasicFilter = () => {\n  // If the basic filter is empty, reset all filters\n  if (!basicFilter.value.trim()) {\n    resetFilters()\n    return\n  }\n  emit('filter', { basic: basicFilter.value, advanced: null })\n}\n\n// Apply advanced filters\nconst applyAdvancedFilters = () => {\n  emit('filter', { basic: null, advanced: advancedFilters.value })\n}\n\n// Reset filters\nconst resetFilters = () => {\n  basicFilter.value = ''\n  Object.keys(advancedFilters.value).forEach(key => {\n    advancedFilters.value[key] = ''\n  })\n  emit('filter', { basic: '', advanced: null })\n}\n\n// Toggle advanced filter visibility\nconst toggleAdvancedFilter = () => {\n  showAdvancedFilter.value = !showAdvancedFilter.value\n}\n\n// Fetch reference data on component mount\nfetchReferenceData()\n</script>\n\n<template>\n  <div class=\"car-stock-filter\">\n    <!-- Basic Filter -->\n    <div class=\"basic-filter\">\n      <div class=\"filter-row\">\n        <div class=\"filter-input\">\n          <input \n            type=\"text\" \n            v-model=\"basicFilter\" \n            placeholder=\"Search by ID, Car, Color, VIN, Ports, Client...\" \n            @input=\"applyBasicFilter\"\n          />\n        </div>\n        <div class=\"filter-actions\">\n          <button @click=\"toggleAdvancedFilter\" class=\"toggle-btn\">\n            {{ showAdvancedFilter ? 'Hide Advanced' : 'Show Advanced' }}\n          </button>\n          <button @click=\"resetFilters\" class=\"reset-btn\">Reset</button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Advanced Filters -->\n    <div v-if=\"showAdvancedFilter\" class=\"advanced-filters\">\n      <div class=\"filter-grid\">\n        <!-- ID Filter -->\n        <div class=\"filter-field\">\n          <label for=\"id-filter\">ID</label>\n          <input \n            id=\"id-filter\" \n            type=\"text\" \n            v-model=\"advancedFilters.id\" \n            placeholder=\"Car ID\"\n          />\n        </div>\n\n        <!-- Car Name Filter -->\n        <div class=\"filter-field\">\n          <label for=\"car-name-filter\">Car</label>\n          <select \n            id=\"car-name-filter\" \n            v-model=\"advancedFilters.car_name\"\n          >\n            <option value=\"\">All Cars</option>\n            <option \n              v-for=\"car in carNames\" \n              :key=\"car.id\" \n              :value=\"car.car_name\"\n            >\n              {{ car.car_name }}\n            </option>\n          </select>\n        </div>\n\n        <!-- Color Filter -->\n        <div class=\"filter-field\">\n          <label for=\"color-filter\">Color</label>\n          <select \n            id=\"color-filter\" \n            v-model=\"advancedFilters.color\"\n          >\n            <option value=\"\">All Colors</option>\n            <option \n              v-for=\"color in colors\" \n              :key=\"color.id\" \n              :value=\"color.color\"\n            >\n              {{ color.color }}\n            </option>\n          </select>\n        </div>\n\n        <!-- VIN Filter -->\n        <div class=\"filter-field\">\n          <label for=\"vin-filter\">VIN</label>\n          <input \n            id=\"vin-filter\" \n            type=\"text\" \n            v-model=\"advancedFilters.vin\" \n            placeholder=\"VIN Number\"\n          />\n        </div>\n\n        <!-- Loading Port Filter -->\n        <div class=\"filter-field\">\n          <label for=\"loading-port-filter\">Loading Port</label>\n          <select \n            id=\"loading-port-filter\" \n            v-model=\"advancedFilters.loading_port\"\n          >\n            <option value=\"\">All Loading Ports</option>\n            <option \n              v-for=\"port in loadingPorts\" \n              :key=\"port.id\" \n              :value=\"port.loading_port\"\n            >\n              {{ port.loading_port }}\n            </option>\n          </select>\n        </div>\n\n        <!-- Discharge Port Filter -->\n        <div class=\"filter-field\">\n          <label for=\"discharge-port-filter\">Discharge Port</label>\n          <select \n            id=\"discharge-port-filter\" \n            v-model=\"advancedFilters.discharge_port\"\n          >\n            <option value=\"\">All Discharge Ports</option>\n            <option \n              v-for=\"port in dischargePorts\" \n              :key=\"port.id\" \n              :value=\"port.discharge_port\"\n            >\n              {{ port.discharge_port }}\n            </option>\n          </select>\n        </div>\n\n        <!-- Freight Range Filter -->\n        <div class=\"filter-field range-field\">\n          <label>Freight Range</label>\n          <div class=\"range-inputs\">\n            <input \n              type=\"number\" \n              v-model=\"advancedFilters.freight_min\" \n              placeholder=\"Min\"\n            />\n            <input \n              type=\"number\" \n              v-model=\"advancedFilters.freight_max\" \n              placeholder=\"Max\"\n            />\n          </div>\n        </div>\n\n        <!-- Price Range Filter -->\n        <div class=\"filter-field range-field\">\n          <label>Price Range</label>\n          <div class=\"range-inputs\">\n            <input \n              type=\"number\" \n              v-model=\"advancedFilters.price_min\" \n              placeholder=\"Min\"\n            />\n            <input \n              type=\"number\" \n              v-model=\"advancedFilters.price_max\" \n              placeholder=\"Max\"\n            />\n          </div>\n        </div>\n\n        <!-- Loading Date Range Filter -->\n        <div class=\"filter-field range-field\">\n          <label>Loading Date Range</label>\n          <div class=\"range-inputs\">\n            <input \n              type=\"date\" \n              v-model=\"advancedFilters.loading_date_from\" \n            />\n            <input \n              type=\"date\" \n              v-model=\"advancedFilters.loading_date_to\" \n            />\n          </div>\n        </div>\n\n        <!-- Status Filter -->\n        <div class=\"filter-field\">\n          <label for=\"status-filter\">Status</label>\n          <select \n            id=\"status-filter\" \n            v-model=\"advancedFilters.status\"\n          >\n            <option value=\"\">All Status</option>\n            <option value=\"available\">Available</option>\n            <option value=\"sold\">Sold</option>\n          </select>\n        </div>\n\n        <!-- Client Filter -->\n        <div class=\"filter-field\">\n          <label for=\"client-filter\">Client</label>\n          <select \n            id=\"client-filter\" \n            v-model=\"advancedFilters.client\"\n          >\n            <option value=\"\">All Clients</option>\n            <option \n              v-for=\"client in clients\" \n              :key=\"client.id\" \n              :value=\"client.name\"\n            >\n              {{ client.name }}\n            </option>\n          </select>\n        </div>\n\n        <!-- Warehouse Filter -->\n        <div class=\"filter-field\">\n          <label for=\"warehouse-filter\">Warehouse</label>\n          <select \n            id=\"warehouse-filter\" \n            v-model=\"advancedFilters.warehouse\"\n          >\n            <option value=\"\">All Warehouses</option>\n            <option \n              v-for=\"warehouse in warehouses\" \n              :key=\"warehouse.id\" \n              :value=\"warehouse.name\"\n            >\n              {{ warehouse.name }}\n            </option>\n          </select>\n      </div>\n\n        <!-- Add the Apply and Reset buttons at the bottom -->\n      <div class=\"advanced-filter-actions\">\n        <button @click=\"applyAdvancedFilters\" class=\"apply-btn\">Apply Filters</button>\n        <button @click=\"resetFilters\" class=\"reset-btn\">Reset All</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.car-stock-filter {\n  margin-bottom: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  padding: 16px;\n}\n\n.filter-row {\n  display: flex;\n  gap: 12px;\n  align-items: center;\n}\n\n.filter-input {\n  flex: 1;\n}\n\n.filter-input input {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.filter-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.toggle-btn, .reset-btn, .apply-btn {\n  padding: 10px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.toggle-btn {\n  background-color: #6366f1;\n  color: white;\n}\n\n.reset-btn {\n  background-color: #9ca3af;\n  color: white;\n}\n\n.apply-btn {\n  background-color: #10b981;\n  color: white;\n}\n\n.toggle-btn:hover {\n  background-color: #4f46e5;\n}\n\n.reset-btn:hover {\n  background-color: #6b7280;\n}\n\n.apply-btn:hover {\n  background-color: #059669;\n}\n\n.advanced-filters {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.filter-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 16px;\n}\n\n.filter-field {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.filter-field label {\n  font-size: 14px;\n  font-weight: 500;\n  color: #4b5563;\n}\n\n.filter-field input,\n.filter-field select {\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.range-inputs,\n.date-inputs {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.range-inputs input,\n.date-inputs input {\n  flex: 1;\n}\n\n.range-inputs span,\n.date-inputs span {\n  color: #6b7280;\n  font-size: 12px;\n}\n\n.advanced-filter-actions {\n  grid-column: 1 / -1;  /* Make it span all columns */\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.apply-btn {\n  background-color: #10b981;\n  color: white;\n  padding: 10px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  transition: background-color 0.2s;\n}\n\n.apply-btn:hover {\n  background-color: #059669;\n}\n</style>","<script setup>\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport CarStockTable from '../components/car-stock/CarStockTable.vue'\nimport CarStockForm from '../components/car-stock/CarStockForm.vue'\nimport CarStockFilter from '../components/car-stock/CarStockFilter.vue'\n\nconst router = useRouter()\nconst showEditDialog = ref(false)\nconst editingCar = ref(null)\nconst carStockTableRef = ref(null)\nconst filters = ref({\n  basic: '',\n  advanced: null\n})\n\nconst handleEditCar = (car) => {\n  editingCar.value = { ...car }\n  showEditDialog.value = true\n}\n\nconst handleSave = () => {\n  showEditDialog.value = false\n  \n  // Refresh the table\n  if (carStockTableRef.value) {\n    carStockTableRef.value.fetchCarsStock()\n  }\n}\n\nconst handleFilter = (filterData) => {\n  filters.value = filterData\n  \n  // Refresh the table with the new filters\n  if (carStockTableRef.value) {\n    carStockTableRef.value.fetchCarsStock()\n  }\n}\n\nconst navigateToWarehouses = () => {\n  router.push('/warehouses')\n}\n</script>\n\n<template>\n  <div class=\"cars-stock\">\n    <div class=\"header\">\n      <h2>Cars Stock Management</h2>\n    </div>\n    \n    <div class=\"content\">\n      <!-- Add the filter component -->\n      <CarStockFilter @filter=\"handleFilter\" />\n      \n      <CarStockTable \n        ref=\"carStockTableRef\"\n        :onEdit=\"handleEditCar\"\n        :filters=\"filters\"\n      />\n      \n      <!-- Add Warehouses Button at the bottom -->\n      <div class=\"warehouses-button-container\">\n        <button @click=\"navigateToWarehouses\" class=\"warehouses-btn\">\n          Manage Warehouses\n        </button>\n      </div>\n    </div>\n    \n    <!-- Edit Dialog -->\n    <div v-if=\"showEditDialog\" class=\"dialog-overlay\">\n      <div class=\"dialog\">\n        <CarStockForm\n          :carData=\"editingCar\"\n          @save=\"handleSave\"\n          @cancel=\"showEditDialog = false\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.cars-stock {\n  padding: 20px;\n}\n\n.header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.content {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.dialog {\n  background-color: white;\n  border-radius: 8px;\n  padding: 24px;\n  width: 90%;\n  max-width: 1200px;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\n/* Add these styles for the warehouses button */\n.warehouses-button-container {\n  margin-top: 20px;\n  text-align: center;\n}\n\n.warehouses-btn {\n  background-color: #4CAF50;\n  color: white;\n  padding: 12px 24px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  transition: background-color 0.3s;\n}\n\n.warehouses-btn:hover {\n  background-color: #45a049;\n}\n</style>"],"names":["props","__props","emit","__emit","callApi","useApi","newVin","ref","loading","error","handleSubmit","result","err","closeModal","success","documentsFile","sellPiFile","buyPiFile","handleFileUpload","file","type","formData","updates","documentsPath","sellPiPath","buyPiPath","setClause","key","handleFileChange","event","fileRef","loadingPorts","dischargePorts","selectedLoadingPort","selectedDischargePort","fetchPorts","loadingPortsResult","dischargePortsResult","params","updatedCar","loadingPort","p","dischargePort","onMounted","price","freight","rate","warehouses","selectedWarehouse","user","can_receive_car","computed","_a","fetchWarehouses","handleGetCar","currentDate","handleWarehouseChange","warehouse","w","exportLicenseRef","handleGetBL","handleFreightPaid","handleDocsFromSupplier","handleDocsSentToClient","handleExportLicenseUpdate","handleLoad","filters","applyFilters","resetFilters","watch","newFilters","isDropdownOpen","fetchCarsStock","can_edit_cars_prop","getFileUrl","cars","showVinEditForm","selectedCar","can_edit_vin","showFilesUploadForm","can_upload_car_files","showPortsEditForm","can_edit_cars_ports","showMoneyEditForm","can_edit_car_money","showWarehouseForm","can_edit_warehouse","showDocumentsForm","selectedCarForDocuments","can_edit_car_documents","showLoadForm","selectedCarForLoad","can_load_car","showAdvancedFilter","advancedFilters","query","searchTerm","i","adv","handleEdit","car","toggleDropdown","carId","newDropdownState","handleVINAction","handleVinSave","index","c","handleFilesAction","handleFilesSave","handlePortsAction","handlePortsSave","handleMoneyAction","handleMoneySave","handleWarehouseAction","handleWarehouseSave","handleDocumentsClick","handleDocumentsClose","handleDocumentsSave","handleLoadClick","handleLoadClose","handleLoadSave","closeAllDropdowns","handleClickOutside","dropdowns","clickedOutside","dropdown","handleAdvancedFilters","userStr","onUnmounted","__expose","can_edit_car_client_name","can_edit_cars_sell_price","can_edit_cars_sell_rate","can_edit_cars_discharge_port","uploadFile","clients","buyDetails","fileType","uploadSingleFile","folder","customFilename","originalExt","filename","date","dateStr","newData","field","fetchReferenceData","clientsResult","buyDetailsResult","warehousesResult","saveCar","carNames","colors","basicFilter","carNamesResult","colorsResult","applyBasicFilter","applyAdvancedFilters","toggleAdvancedFilter","router","useRouter","showEditDialog","editingCar","carStockTableRef","handleEditCar","handleSave","handleFilter","filterData","navigateToWarehouses"],"mappings":"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"}
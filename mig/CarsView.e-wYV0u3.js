import{_ as H,r as b,u as z,j as G,o as K,c as a,g as s,a as e,b as D,F as P,d as L,t as m,f as ae,w as p,v as S,p as F,n as Y,e as M,q as te,s as ce,x as ee,i as oe,h as ve,m as W,k as pe}from"./index.CoJVpPtY.js";import be from"./CarsStock.CUGVvKds.js";import me from"./SellBillsView.B3lIYNB7.js";import _e from"./WarehousesView.BUHxpHJz.js";const ye={class:"clients-view"},ge={class:"header"},fe={class:"content"},ke={class:"clients-table"},Ee={class:"id-document-cell"},Ce=["onClick"],$e=["src","alt"],we=["href"],Se={key:2},he=["onClick"],Ae=["onClick"],De={key:0,class:"dialog-overlay"},Ne={class:"dialog"},Te={class:"form-group"},Ue={class:"file-upload"},Re={key:0,class:"error-message"},Ve={class:"dialog-actions"},Be=["disabled"],Oe={key:1,class:"dialog-overlay"},Pe={class:"dialog"},Le={class:"form-group"},qe=["readonly"],Ie={class:"file-upload"},Fe={key:0,class:"current-file"},Me=["href"],xe={key:0,class:"error-message"},We={class:"dialog-actions"},He=["disabled"],Ye={__name:"ClientsView",setup(I){const A=b([]),{callApi:g,uploadFile:$,getFileUrl:N,error:f}=z(),i=b(!1),V=b(!1),v=b(null),E=b(null),O=b(""),B=b(null),w=b(null),_=G(()=>{var y;return((y=E.value)==null?void 0:y.role_id)===1}),c=y=>{if(!y)return!1;const o=y.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(o)},d=y=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y),n=b({name:"",address:"",email:"",mobiles:"",id_no:""}),k=async()=>{const y=await g({query:`
      SELECT * FROM clients where is_broker = 0
      ORDER BY name ASC
    `,params:[]});y.success&&(A.value=y.data)},R=(y,o=!1)=>{const u=y.target.files[0];o?w.value=u:B.value=u},h=async()=>{if(!d(n.value.email)){O.value="Please enter a valid email address";return}try{const y=await g({query:`
      INSERT INTO clients (name, address, email, mobiles, id_no, is_broker)
      VALUES (?, ?, ?, ?, ?, 0)
    `,params:[n.value.name,n.value.address,n.value.email,n.value.mobiles,n.value.id_no]});if(y.success){const o=y.insertId;if(B.value)try{const u=`${o}.${B.value.name.split(".").pop()}`,x=await $(B.value,"ids",u);x.success&&await g({query:"UPDATE clients SET id_copy_path = ? WHERE id = ?",params:[x.relativePath,o]})}catch(u){console.error("Error uploading file:",u),f.value="Client created but failed to upload ID document"}i.value=!1,O.value="",B.value=null,n.value={name:"",address:"",email:"",mobiles:"",id_no:""},await k()}else f.value=y.error,console.error("Error adding client:",y.error)}catch(y){f.value=y.message,console.error("Error in add client process:",y)}},q=y=>{v.value={...y},w.value=null,V.value=!0},J=async()=>{if(!d(v.value.email)){O.value="Please enter a valid email address";return}try{const y=await g({query:`
      UPDATE clients 
      SET name = ?, address = ?, email = ?, mobiles = ?, id_no = ?, is_broker = 0
      WHERE id = ?
    `,params:[v.value.name,v.value.address,v.value.email,v.value.mobiles,v.value.id_no,v.value.id]});if(y.success){if(w.value)try{const o=`${v.value.id}.${w.value.name.split(".").pop()}`,u=await $(w.value,"ids",o);u.success&&await g({query:"UPDATE clients SET id_copy_path = ? WHERE id = ?",params:[u.relativePath,v.value.id]})}catch(o){console.error("Error uploading file:",o),f.value="Client updated but failed to upload new ID document"}V.value=!1,v.value=null,w.value=null,O.value="",await k()}else f.value=y.error,console.error("Error updating client:",y.error)}catch(y){f.value=y.message,console.error("Error in update client process:",y)}},Q=async y=>{confirm("Are you sure you want to delete this client?")&&(await g({query:"DELETE FROM clients WHERE id = ?",params:[y.id]})).success&&await k()},X=y=>{y&&window.open(N(y),"_blank")};return K(()=>{const y=localStorage.getItem("user");y&&(E.value=JSON.parse(y),k())}),(y,o)=>(s(),a("div",ye,[e("div",ge,[o[15]||(o[15]=e("h2",null,"Clients Management",-1)),e("button",{onClick:o[0]||(o[0]=u=>i.value=!0),class:"add-btn"},"Add Client")]),e("div",fe,[e("table",ke,[o[16]||(o[16]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Address"),e("th",null,"Email"),e("th",null,"Mobile"),e("th",null,"ID No"),e("th",null,"ID Document"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,u=>(s(),a("tr",{key:u.id},[e("td",null,m(u.name),1),e("td",null,m(u.address),1),e("td",null,m(u.email),1),e("td",null,m(u.mobiles),1),e("td",null,m(u.id_no),1),e("td",Ee,[u.id_copy_path&&c(u.id_copy_path)?(s(),a("div",{key:0,class:"image-preview",onClick:x=>X(u.id_copy_path)},[e("img",{src:ae(N)(u.id_copy_path),alt:"ID for "+u.name},null,8,$e)],8,Ce)):u.id_copy_path?(s(),a("a",{key:1,href:ae(N)(u.id_copy_path),target:"_blank",class:"document-link"}," View Document ",8,we)):(s(),a("span",Se,"No ID"))]),e("td",null,[e("button",{onClick:x=>q(u),class:"btn edit-btn"},"Edit",8,he),_.value?(s(),a("button",{key:0,onClick:x=>Q(u),class:"btn delete-btn"},"Delete",8,Ae)):D("",!0)])]))),128))])])]),i.value?(s(),a("div",De,[e("div",Ne,[o[18]||(o[18]=e("h3",null,"Add New Client",-1)),e("div",Te,[p(e("input",{"onUpdate:modelValue":o[1]||(o[1]=u=>n.value.name=u),placeholder:"Name",class:"input-field"},null,512),[[S,n.value.name]]),p(e("input",{"onUpdate:modelValue":o[2]||(o[2]=u=>n.value.address=u),placeholder:"Address",class:"input-field"},null,512),[[S,n.value.address]]),p(e("input",{"onUpdate:modelValue":o[3]||(o[3]=u=>n.value.email=u),placeholder:"Email",class:F(["input-field",{error:O.value&&n.value.email}])},null,2),[[S,n.value.email]]),p(e("input",{"onUpdate:modelValue":o[4]||(o[4]=u=>n.value.mobiles=u),placeholder:"Mobile",class:"input-field"},null,512),[[S,n.value.mobiles]]),p(e("input",{"onUpdate:modelValue":o[5]||(o[5]=u=>n.value.id_no=u),placeholder:"ID No",class:"input-field"},null,512),[[S,n.value.id_no]]),e("div",Ue,[o[17]||(o[17]=e("label",{for:"id-document"},"ID Document:",-1)),e("input",{type:"file",id:"id-document",onChange:o[6]||(o[6]=u=>R(u)),accept:"image/*,.pdf",class:"file-input"},null,32)]),O.value?(s(),a("div",Re,m(O.value),1)):D("",!0)]),e("div",Ve,[e("button",{onClick:h,class:"btn save-btn",disabled:!_.value},"Add",8,Be),e("button",{onClick:o[7]||(o[7]=u=>i.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),V.value?(s(),a("div",Oe,[e("div",Pe,[o[21]||(o[21]=e("h3",null,"Edit Client",-1)),e("div",Le,[p(e("input",{"onUpdate:modelValue":o[8]||(o[8]=u=>v.value.name=u),placeholder:"Name",class:"input-field",readonly:!_.value},null,8,qe),[[S,v.value.name]]),p(e("input",{"onUpdate:modelValue":o[9]||(o[9]=u=>v.value.address=u),placeholder:"Address",class:"input-field"},null,512),[[S,v.value.address]]),p(e("input",{"onUpdate:modelValue":o[10]||(o[10]=u=>v.value.email=u),placeholder:"Email",class:F(["input-field",{error:O.value&&v.value.email}])},null,2),[[S,v.value.email]]),p(e("input",{"onUpdate:modelValue":o[11]||(o[11]=u=>v.value.mobiles=u),placeholder:"Mobile",class:"input-field"},null,512),[[S,v.value.mobiles]]),p(e("input",{"onUpdate:modelValue":o[12]||(o[12]=u=>v.value.id_no=u),placeholder:"ID No",class:"input-field"},null,512),[[S,v.value.id_no]]),e("div",Ie,[o[20]||(o[20]=e("label",{for:"edit-id-document"},"ID Document:",-1)),v.value.id_copy_path?(s(),a("div",Fe,[o[19]||(o[19]=Y(" Current: ")),e("a",{href:v.value.id_copy_path,target:"_blank"},"View ID",8,Me)])):D("",!0),e("input",{type:"file",id:"edit-id-document",onChange:o[13]||(o[13]=u=>R(u,!0)),accept:"image/*,.pdf",class:"file-input"},null,32)]),O.value?(s(),a("div",xe,m(O.value),1)):D("",!0)]),e("div",We,[e("button",{onClick:J,class:"btn save-btn",disabled:!_.value},"Save",8,He),e("button",{onClick:o[14]||(o[14]=u=>V.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},Je=H(Ye,[["__scopeId","data-v-c10137e8"]]),Qe={class:"clients-view"},je={class:"header"},ze={class:"content"},Ge={class:"clients-table"},Ke=["onClick"],Xe=["onClick"],Ze={key:0,class:"dialog-overlay"},el={class:"dialog"},ll={class:"form-group"},tl={key:0,class:"error-message"},sl={class:"dialog-actions"},al=["disabled"],ol={key:1,class:"dialog-overlay"},nl={class:"dialog"},il={class:"form-group"},dl=["readonly"],ul={key:0,class:"error-message"},rl={class:"dialog-actions"},cl=["disabled"],vl={__name:"BrokersView",setup(I){const A=b([]),{callApi:g,error:$}=z(),N=b(!1),f=b(!1),i=b(null),V=b(null),v=b(""),E=G(()=>{var k;return((k=V.value)==null?void 0:k.role_id)===1}),O=k=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k),B=b({name:"",address:"",email:"",mobiles:"",id_no:""}),w=async()=>{const k=await g({query:`
      SELECT * FROM clients where is_broker = 1
      ORDER BY name ASC
    `,params:[]});k.success&&(A.value=k.data)},_=async()=>{if(!O(B.value.email)){v.value="Please enter a valid email address";return}const k=await g({query:`
      INSERT INTO clients (name, address, email, mobiles, id_no, is_broker)
      VALUES (?, ?, ?, ?, ?, 1)
    `,params:[B.value.name,B.value.address,B.value.email,B.value.mobiles,B.value.id_no]});k.success?(N.value=!1,v.value="",B.value={name:"",address:"",email:"",mobiles:"",id_no:""},await w()):($.value=k.error,console.error("Error adding client:",k.error))},c=k=>{i.value={...k},f.value=!0},d=async()=>{if(!O(i.value.email)){v.value="Please enter a valid email address";return}const k=await g({query:`
      UPDATE clients 
      SET name = ?, address = ?, email = ?, mobiles = ?, id_no = ?, is_broker = 1
      WHERE id = ?
    `,params:[i.value.name,i.value.address,i.value.email,i.value.mobiles,i.value.id_no,i.value.id]});k.success?(f.value=!1,i.value=null,v.value="",await w()):($.value=k.error,console.error("Error updating client:",k.error))},n=async k=>{confirm("Are you sure you want to delete this client?")&&(await g({query:"DELETE FROM clients WHERE id = ?",params:[k.id]})).success&&await w()};return K(()=>{const k=localStorage.getItem("user");k&&(V.value=JSON.parse(k),w())}),(k,R)=>(s(),a("div",Qe,[e("div",je,[R[13]||(R[13]=e("h2",null,"Brokers Management",-1)),e("button",{onClick:R[0]||(R[0]=h=>N.value=!0),class:"add-btn"},"Add Client")]),e("div",ze,[e("table",Ge,[R[14]||(R[14]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Address"),e("th",null,"Email"),e("th",null,"Mobile"),e("th",null,"ID No"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,h=>(s(),a("tr",{key:h.id},[e("td",null,m(h.name),1),e("td",null,m(h.address),1),e("td",null,m(h.email),1),e("td",null,m(h.mobiles),1),e("td",null,m(h.id_no),1),e("td",null,[e("button",{onClick:q=>c(h),class:"btn edit-btn"},"Edit",8,Ke),E.value?(s(),a("button",{key:0,onClick:q=>n(h),class:"btn delete-btn"},"Delete",8,Xe)):D("",!0)])]))),128))])])]),N.value?(s(),a("div",Ze,[e("div",el,[R[15]||(R[15]=e("h3",null,"Add New Client",-1)),e("div",ll,[p(e("input",{"onUpdate:modelValue":R[1]||(R[1]=h=>B.value.name=h),placeholder:"Name",class:"input-field"},null,512),[[S,B.value.name]]),p(e("input",{"onUpdate:modelValue":R[2]||(R[2]=h=>B.value.address=h),placeholder:"Address",class:"input-field"},null,512),[[S,B.value.address]]),p(e("input",{"onUpdate:modelValue":R[3]||(R[3]=h=>B.value.email=h),placeholder:"Email",class:F(["input-field",{error:v.value&&B.value.email}])},null,2),[[S,B.value.email]]),p(e("input",{"onUpdate:modelValue":R[4]||(R[4]=h=>B.value.mobiles=h),placeholder:"Mobile",class:"input-field"},null,512),[[S,B.value.mobiles]]),p(e("input",{"onUpdate:modelValue":R[5]||(R[5]=h=>B.value.id_no=h),placeholder:"ID No",class:"input-field"},null,512),[[S,B.value.id_no]]),v.value?(s(),a("div",tl,m(v.value),1)):D("",!0)]),e("div",sl,[e("button",{onClick:_,class:"btn save-btn",disabled:!E.value},"Add",8,al),e("button",{onClick:R[6]||(R[6]=h=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),f.value?(s(),a("div",ol,[e("div",nl,[R[16]||(R[16]=e("h3",null,"Edit Client",-1)),e("div",il,[p(e("input",{"onUpdate:modelValue":R[7]||(R[7]=h=>i.value.name=h),placeholder:"Name",class:"input-field",readonly:!E.value},null,8,dl),[[S,i.value.name]]),p(e("input",{"onUpdate:modelValue":R[8]||(R[8]=h=>i.value.address=h),placeholder:"Address",class:"input-field"},null,512),[[S,i.value.address]]),p(e("input",{"onUpdate:modelValue":R[9]||(R[9]=h=>i.value.email=h),placeholder:"Email",class:F(["input-field",{error:v.value&&i.value.email}])},null,2),[[S,i.value.email]]),p(e("input",{"onUpdate:modelValue":R[10]||(R[10]=h=>i.value.mobiles=h),placeholder:"Mobile",class:"input-field"},null,512),[[S,i.value.mobiles]]),p(e("input",{"onUpdate:modelValue":R[11]||(R[11]=h=>i.value.id_no=h),placeholder:"ID No",class:"input-field"},null,512),[[S,i.value.id_no]]),v.value?(s(),a("div",ul,m(v.value),1)):D("",!0)]),e("div",rl,[e("button",{onClick:d,class:"btn save-btn",disabled:!E.value},"Save",8,cl),e("button",{onClick:R[12]||(R[12]=h=>f.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},pl=H(vl,[["__scopeId","data-v-8051a3ee"]]),bl={class:"suppliers-view"},ml={class:"header"},_l={class:"content"},yl={class:"suppliers-table"},gl=["onClick"],fl=["onClick"],kl={key:0,class:"dialog-overlay"},El={class:"dialog"},Cl={class:"form-group"},$l={class:"dialog-actions"},wl={key:1,class:"dialog-overlay"},Sl={class:"dialog"},hl={class:"form-group"},Al={class:"dialog-actions"},Dl={__name:"SuppliersView",setup(I){const A=b([]),{callApi:g,error:$}=z(),N=b(!1),f=b(!1),i=b(null),V=b(null),v=G(()=>{var d;return((d=V.value)==null?void 0:d.role_id)===1}),E=b({name:"",contact_info:"",notes:""}),O=async()=>{const d=await g({query:`
      SELECT * FROM suppliers
      ORDER BY name ASC
    `,params:[]});d.success&&(A.value=d.data)},B=async()=>{const d=await g({query:`
      INSERT INTO suppliers (name, contact_info, notes)
      VALUES (?, ?, ?)
    `,params:[E.value.name,E.value.contact_info,E.value.notes]});d.success?(N.value=!1,E.value={name:"",contact_info:"",notes:""},await O()):($.value=d.error,console.error("Error adding supplier:",d.error))},w=d=>{i.value={...d},f.value=!0},_=async()=>{const d=await g({query:`
      UPDATE suppliers 
      SET name = ?, contact_info = ?, notes = ?
      WHERE id = ?
    `,params:[i.value.name,i.value.contact_info,i.value.notes,i.value.id]});d.success?(f.value=!1,i.value=null,await O()):($.value=d.error,console.error("Error updating supplier:",d.error))},c=async d=>{confirm("Are you sure you want to delete this supplier?")&&(await g({query:"DELETE FROM suppliers WHERE id = ?",params:[d.id]})).success&&await O()};return K(()=>{const d=localStorage.getItem("user");d&&(V.value=JSON.parse(d),O())}),(d,n)=>(s(),a("div",bl,[e("div",ml,[n[9]||(n[9]=e("h2",null,"Suppliers Management",-1)),e("button",{onClick:n[0]||(n[0]=k=>N.value=!0),class:"add-btn"},"Add Supplier")]),e("div",_l,[e("table",yl,[n[10]||(n[10]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Contact Info"),e("th",null,"Notes"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,k=>(s(),a("tr",{key:k.id},[e("td",null,m(k.name),1),e("td",null,m(k.contact_info),1),e("td",null,m(k.notes),1),e("td",null,[e("button",{onClick:R=>w(k),class:"btn edit-btn"},"Edit",8,gl),v.value?(s(),a("button",{key:0,onClick:R=>c(k),class:"btn delete-btn"},"Delete",8,fl)):D("",!0)])]))),128))])])]),N.value?(s(),a("div",kl,[e("div",El,[n[11]||(n[11]=e("h3",null,"Add New Supplier",-1)),e("div",Cl,[p(e("input",{"onUpdate:modelValue":n[1]||(n[1]=k=>E.value.name=k),placeholder:"Name",class:"input-field"},null,512),[[S,E.value.name]]),p(e("textarea",{"onUpdate:modelValue":n[2]||(n[2]=k=>E.value.contact_info=k),placeholder:"Contact Information",class:"input-field textarea"},null,512),[[S,E.value.contact_info]]),p(e("textarea",{"onUpdate:modelValue":n[3]||(n[3]=k=>E.value.notes=k),placeholder:"Notes",class:"input-field textarea"},null,512),[[S,E.value.notes]])]),e("div",$l,[e("button",{onClick:B,class:"btn save-btn"},"Save"),e("button",{onClick:n[4]||(n[4]=k=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),f.value?(s(),a("div",wl,[e("div",Sl,[n[12]||(n[12]=e("h3",null,"Edit Supplier",-1)),e("div",hl,[p(e("input",{"onUpdate:modelValue":n[5]||(n[5]=k=>i.value.name=k),placeholder:"Name",class:"input-field"},null,512),[[S,i.value.name]]),p(e("textarea",{"onUpdate:modelValue":n[6]||(n[6]=k=>i.value.contact_info=k),placeholder:"Contact Information",class:"input-field textarea"},null,512),[[S,i.value.contact_info]]),p(e("textarea",{"onUpdate:modelValue":n[7]||(n[7]=k=>i.value.notes=k),placeholder:"Notes",class:"input-field textarea"},null,512),[[S,i.value.notes]])]),e("div",Al,[e("button",{onClick:_,class:"btn save-btn"},"Save"),e("button",{onClick:n[8]||(n[8]=k=>f.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},Nl=H(Dl,[["__scopeId","data-v-c8ee631a"]]),Tl={class:"models-view"},Ul={class:"section"},Rl={class:"header"},Vl={class:"data-table"},Bl=["onClick"],Ol=["onClick"],Pl={class:"section"},Ll={class:"header"},ql={class:"data-table"},Il=["onClick"],Fl=["onClick"],Ml={key:0,class:"dialog-overlay"},xl={class:"dialog"},Wl={class:"form-group"},Hl={class:"dialog-actions"},Yl={key:1,class:"dialog-overlay"},Jl={class:"dialog"},Ql={class:"form-group"},jl={class:"dialog-actions"},zl={key:2,class:"dialog-overlay"},Gl={class:"dialog"},Kl={class:"form-group"},Xl={class:"form-group"},Zl=["value"],et={class:"form-group"},lt={class:"form-group"},tt={class:"dialog-buttons"},st={key:3,class:"dialog-overlay"},at={class:"dialog"},ot={class:"form-group"},nt={class:"form-group"},it=["value"],dt={class:"form-group"},ut={class:"form-group"},rt={class:"dialog-buttons"},ct={__name:"CarModelsView",setup(I){const{callApi:A}=z(),g=b(!1),$=b(!1),N=b(!1),f=b(!1),i=b([]),V=b([]),v=b(null),E=b(null),O=b(null),B=G(()=>{var y;return((y=O.value)==null?void 0:y.role_id)===1}),w=b({brand:""}),_=b({car_name:"",notes:"",is_big_car:!1,id_brand:null}),c=async()=>{const y=await A({query:"SELECT * FROM brands ORDER BY brand ASC",params:[]});y.success&&(i.value=y.data)},d=async()=>{const y=await A({query:`
      SELECT cn.*, b.brand 
      FROM cars_names cn
      LEFT JOIN brands b ON cn.id_brand = b.id 
      ORDER BY cn.car_name ASC
    `,params:[]});y.success&&(V.value=y.data)},n=async()=>{const y=await A({query:"INSERT INTO brands (brand) VALUES (?)",params:[w.value.brand]});y.success?(g.value=!1,w.value={brand:""},await c()):console.log(y.error)},k=async()=>{const y=await A({query:"INSERT INTO cars_names (car_name, notes, is_big_car, id_brand) VALUES (?, ?, ?, ?)",params:[_.value.car_name,_.value.notes,_.value.is_big_car?1:0,_.value.id_brand]});y.success?(N.value=!1,_.value={car_name:"",notes:"",is_big_car:!1,id_brand:null},await d()):console.log(y.error)},R=y=>{v.value={...y},$.value=!0},h=y=>{E.value={...y},f.value=!0},q=async()=>{const y=await A({query:"UPDATE brands SET brand = ? WHERE id = ?",params:[v.value.brand,v.value.id]});y.success?($.value=!1,v.value=null,await c()):console.log(y.error)},J=async()=>{const y=await A({query:"UPDATE cars_names SET car_name = ?, notes = ?, is_big_car = ?, id_brand = ? WHERE id = ?",params:[E.value.car_name,E.value.notes,E.value.is_big_car?1:0,E.value.id_brand,E.value.id]});y.success?(f.value=!1,E.value=null,await d()):console.log(y.error)},Q=async y=>{confirm("Are you sure you want to delete this brand?")&&(await A({query:"DELETE FROM brands WHERE id = ?",params:[y.id]})).success&&await c()},X=async y=>{confirm("Are you sure you want to delete this car name?")&&(await A({query:"DELETE FROM cars_names WHERE id = ?",params:[y.id]})).success&&await d()};return K(()=>{const y=localStorage.getItem("user");y&&(O.value=JSON.parse(y),c(),d())}),(y,o)=>(s(),a("div",Tl,[e("div",Ul,[e("div",Rl,[o[16]||(o[16]=e("h2",null,"Brands Management",-1)),e("button",{onClick:o[0]||(o[0]=u=>g.value=!0),class:"add-btn"},"Add Brand")]),e("table",Vl,[o[17]||(o[17]=e("thead",null,[e("tr",null,[e("th",null,"Brand"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(i.value,u=>(s(),a("tr",{key:u.id},[e("td",null,m(u.brand),1),e("td",null,[e("button",{onClick:x=>R(u),class:"btn edit-btn"},"Edit",8,Bl),B.value?(s(),a("button",{key:0,onClick:x=>Q(u),class:"btn delete-btn"},"Delete",8,Ol)):D("",!0)])]))),128))])])]),e("div",Pl,[e("div",Ll,[o[18]||(o[18]=e("h2",null,"Car Names Management",-1)),e("button",{onClick:o[1]||(o[1]=u=>N.value=!0),class:"add-btn"},"Add Car Name")]),e("table",ql,[o[19]||(o[19]=e("thead",null,[e("tr",null,[e("th",null,"Car Name"),e("th",null,"Brand"),e("th",null,"Notes"),e("th",null,"Big Car"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(V.value,u=>(s(),a("tr",{key:u.id},[e("td",null,m(u.car_name),1),e("td",null,m(u.brand),1),e("td",null,m(u.notes),1),e("td",null,m(u.is_big_car?"Yes":"No"),1),e("td",null,[e("button",{onClick:x=>h(u),class:"btn edit-btn"},"Edit",8,Il),B.value?(s(),a("button",{key:0,onClick:x=>X(u),class:"btn delete-btn"},"Delete",8,Fl)):D("",!0)])]))),128))])])]),g.value?(s(),a("div",Ml,[e("div",xl,[o[20]||(o[20]=e("h3",null,"Add New Brand",-1)),e("div",Wl,[p(e("input",{"onUpdate:modelValue":o[2]||(o[2]=u=>w.value.brand=u),placeholder:"Brand Name",class:"input-field"},null,512),[[S,w.value.brand]])]),e("div",Hl,[e("button",{onClick:n,class:"btn save-btn"},"Save"),e("button",{onClick:o[3]||(o[3]=u=>g.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),$.value?(s(),a("div",Yl,[e("div",Jl,[o[21]||(o[21]=e("h3",null,"Edit Brand",-1)),e("div",Ql,[p(e("input",{"onUpdate:modelValue":o[4]||(o[4]=u=>v.value.brand=u),placeholder:"Brand Name",class:"input-field"},null,512),[[S,v.value.brand]])]),e("div",jl,[e("button",{onClick:q,class:"btn save-btn"},"Save"),e("button",{onClick:o[5]||(o[5]=u=>$.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),N.value?(s(),a("div",zl,[e("div",Gl,[o[24]||(o[24]=e("h3",null,"Add New Car Name",-1)),e("div",Kl,[p(e("input",{"onUpdate:modelValue":o[6]||(o[6]=u=>_.value.car_name=u),placeholder:"Car Name"},null,512),[[S,_.value.car_name]])]),e("div",Xl,[p(e("select",{"onUpdate:modelValue":o[7]||(o[7]=u=>_.value.id_brand=u)},[o[22]||(o[22]=e("option",{value:""},"Select Brand",-1)),(s(!0),a(P,null,L(i.value,u=>(s(),a("option",{key:u.id,value:u.id},m(u.brand),9,Zl))),128))],512),[[M,_.value.id_brand]])]),e("div",et,[p(e("input",{"onUpdate:modelValue":o[8]||(o[8]=u=>_.value.notes=u),placeholder:"Notes"},null,512),[[S,_.value.notes]])]),e("div",lt,[e("label",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=u=>_.value.is_big_car=u)},null,512),[[te,_.value.is_big_car]]),o[23]||(o[23]=Y(" Big Car "))])]),e("div",tt,[e("button",{onClick:k,class:"btn save-btn"},"Save"),e("button",{onClick:o[10]||(o[10]=u=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),f.value?(s(),a("div",st,[e("div",at,[o[27]||(o[27]=e("h3",null,"Edit Car Name",-1)),e("div",ot,[p(e("input",{"onUpdate:modelValue":o[11]||(o[11]=u=>E.value.car_name=u),placeholder:"Car Name"},null,512),[[S,E.value.car_name]])]),e("div",nt,[p(e("select",{"onUpdate:modelValue":o[12]||(o[12]=u=>E.value.id_brand=u)},[o[25]||(o[25]=e("option",{value:""},"Select Brand",-1)),(s(!0),a(P,null,L(i.value,u=>(s(),a("option",{key:u.id,value:u.id},m(u.brand),9,it))),128))],512),[[M,E.value.id_brand]])]),e("div",dt,[p(e("input",{"onUpdate:modelValue":o[13]||(o[13]=u=>E.value.notes=u),placeholder:"Notes"},null,512),[[S,E.value.notes]])]),e("div",ut,[e("label",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":o[14]||(o[14]=u=>E.value.is_big_car=u)},null,512),[[te,E.value.is_big_car]]),o[26]||(o[26]=Y(" Big Car "))])]),e("div",rt,[e("button",{onClick:J,class:"btn save-btn"},"Save"),e("button",{onClick:o[15]||(o[15]=u=>f.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},vt=H(ct,[["__scopeId","data-v-1ce5e605"]]),pt={class:"colors-view"},bt={class:"header"},mt={class:"content"},_t={class:"colors-table"},yt=["onClick"],gt=["onClick"],ft={key:0,class:"dialog-overlay"},kt={class:"dialog"},Et={class:"form-group"},Ct={class:"dialog-actions"},$t={key:1,class:"dialog-overlay"},wt={class:"dialog"},St={class:"form-group"},ht={class:"dialog-actions"},At={__name:"ColorsView",setup(I){const A=b([]),{callApi:g}=z(),$=b(!1),N=b(!1),f=b(null),i=b(null),V=G(()=>{var c;return((c=i.value)==null?void 0:c.role_id)===1}),v=b({color:""}),E=async()=>{const c=await g({query:"SELECT * FROM colors ORDER BY color ASC",params:[]});c.success&&(A.value=c.data)},O=async()=>{(await g({query:"INSERT INTO colors (color) VALUES (?)",params:[v.value.color]})).success&&($.value=!1,v.value={color:""},await E())},B=c=>{f.value={...c},N.value=!0},w=async()=>{(await g({query:"UPDATE colors SET color = ? WHERE id = ?",params:[f.value.color,f.value.id]})).success&&(N.value=!1,f.value=null,await E())},_=async c=>{confirm("Are you sure you want to delete this color?")&&(await g({query:"DELETE FROM colors WHERE id = ?",params:[c.id]})).success&&await E()};return K(()=>{const c=localStorage.getItem("user");c&&(i.value=JSON.parse(c),E())}),(c,d)=>(s(),a("div",pt,[e("div",bt,[d[5]||(d[5]=e("h2",null,"Colors Management",-1)),e("button",{onClick:d[0]||(d[0]=n=>$.value=!0),class:"add-btn"},"Add Color")]),e("div",mt,[e("table",_t,[d[6]||(d[6]=e("thead",null,[e("tr",null,[e("th",null,"Color"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,n=>(s(),a("tr",{key:n.id},[e("td",null,m(n.color),1),e("td",null,[e("button",{onClick:k=>B(n),class:"btn edit-btn"},"Edit",8,yt),V.value?(s(),a("button",{key:0,onClick:k=>_(n),class:"btn delete-btn"},"Delete",8,gt)):D("",!0)])]))),128))])])]),$.value?(s(),a("div",ft,[e("div",kt,[d[7]||(d[7]=e("h3",null,"Add New Color",-1)),e("div",Et,[p(e("input",{"onUpdate:modelValue":d[1]||(d[1]=n=>v.value.color=n),placeholder:"Color Name",class:"input-field"},null,512),[[S,v.value.color]])]),e("div",Ct,[e("button",{onClick:O,class:"btn save-btn"},"Save"),e("button",{onClick:d[2]||(d[2]=n=>$.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),N.value?(s(),a("div",$t,[e("div",wt,[d[8]||(d[8]=e("h3",null,"Edit Color",-1)),e("div",St,[p(e("input",{"onUpdate:modelValue":d[3]||(d[3]=n=>f.value.color=n),placeholder:"Color Name",class:"input-field"},null,512),[[S,f.value.color]])]),e("div",ht,[e("button",{onClick:w,class:"btn save-btn"},"Save"),e("button",{onClick:d[4]||(d[4]=n=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},Dt=H(At,[["__scopeId","data-v-4eb1323d"]]),Nt={class:"ports-view"},Tt={class:"header"},Ut={class:"content"},Rt={class:"ports-table"},Vt=["onClick"],Bt=["onClick"],Ot={key:0,class:"dialog-overlay"},Pt={class:"dialog"},Lt={class:"form-group"},qt={class:"dialog-actions"},It={key:1,class:"dialog-overlay"},Ft={class:"dialog"},Mt={class:"form-group"},xt={class:"dialog-actions"},Wt={__name:"DischargePortsView",setup(I){const A=b([]),{callApi:g}=z(),$=b(!1),N=b(!1),f=b(null),i=b(null),V=G(()=>{var c;return((c=i.value)==null?void 0:c.role_id)===1}),v=b({discharge_port:""}),E=async()=>{const c=await g({query:"SELECT * FROM discharge_ports ORDER BY discharge_port ASC",params:[]});c.success&&(A.value=c.data)},O=async()=>{(await g({query:"INSERT INTO discharge_ports (discharge_port) VALUES (?)",params:[v.value.discharge_port]})).success&&($.value=!1,v.value={discharge_port:""},await E())},B=c=>{f.value={...c},N.value=!0},w=async()=>{(await g({query:"UPDATE discharge_ports SET discharge_port = ? WHERE id = ?",params:[f.value.discharge_port,f.value.id]})).success&&(N.value=!1,f.value=null,await E())},_=async c=>{confirm("Are you sure you want to delete this discharge port?")&&(await g({query:"DELETE FROM discharge_ports WHERE id = ?",params:[c.id]})).success&&await E()};return K(()=>{const c=localStorage.getItem("user");c&&(i.value=JSON.parse(c),E())}),(c,d)=>(s(),a("div",Nt,[e("div",Tt,[d[5]||(d[5]=e("h2",null,"Discharge Ports Management",-1)),e("button",{onClick:d[0]||(d[0]=n=>$.value=!0),class:"add-btn"},"Add Discharge Port")]),e("div",Ut,[e("table",Rt,[d[6]||(d[6]=e("thead",null,[e("tr",null,[e("th",null,"Discharge Port"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,n=>(s(),a("tr",{key:n.id},[e("td",null,m(n.discharge_port),1),e("td",null,[e("button",{onClick:k=>B(n),class:"btn edit-btn"},"Edit",8,Vt),V.value?(s(),a("button",{key:0,onClick:k=>_(n),class:"btn delete-btn"},"Delete",8,Bt)):D("",!0)])]))),128))])])]),$.value?(s(),a("div",Ot,[e("div",Pt,[d[7]||(d[7]=e("h3",null,"Add New Discharge Port",-1)),e("div",Lt,[p(e("input",{"onUpdate:modelValue":d[1]||(d[1]=n=>v.value.discharge_port=n),placeholder:"Discharge Port Name",class:"input-field"},null,512),[[S,v.value.discharge_port]])]),e("div",qt,[e("button",{onClick:O,class:"btn save-btn"},"Save"),e("button",{onClick:d[2]||(d[2]=n=>$.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),N.value?(s(),a("div",It,[e("div",Ft,[d[8]||(d[8]=e("h3",null,"Edit Discharge Port",-1)),e("div",Mt,[p(e("input",{"onUpdate:modelValue":d[3]||(d[3]=n=>f.value.discharge_port=n),placeholder:"Discharge Port Name",class:"input-field"},null,512),[[S,f.value.discharge_port]])]),e("div",xt,[e("button",{onClick:w,class:"btn save-btn"},"Save"),e("button",{onClick:d[4]||(d[4]=n=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},Ht=H(Wt,[["__scopeId","data-v-d7d6cc70"]]),Yt={class:"ports-view"},Jt={class:"header"},Qt={class:"content"},jt={class:"ports-table"},zt=["onClick"],Gt=["onClick"],Kt={key:0,class:"dialog-overlay"},Xt={class:"dialog"},Zt={class:"form-group"},es={class:"dialog-actions"},ls={key:1,class:"dialog-overlay"},ts={class:"dialog"},ss={class:"form-group"},as={class:"dialog-actions"},os={__name:"LoadingPortsView",setup(I){const A=b([]),{callApi:g}=z(),$=b(!1),N=b(!1),f=b(null),i=b(null),V=G(()=>{var c;return((c=i.value)==null?void 0:c.role_id)===1}),v=b({loading_port:""}),E=async()=>{const c=await g({query:"SELECT * FROM loading_ports ORDER BY loading_port ASC",params:[]});c.success&&(A.value=c.data)},O=async()=>{(await g({query:"INSERT INTO loading_ports (loading_port) VALUES (?)",params:[v.value.loading_port]})).success&&($.value=!1,v.value={loading_port:""},await E())},B=c=>{f.value={...c},N.value=!0},w=async()=>{(await g({query:"UPDATE loading_ports SET loading_port = ? WHERE id = ?",params:[f.value.loading_port,f.value.id]})).success&&(N.value=!1,f.value=null,await E())},_=async c=>{confirm("Are you sure you want to delete this loading port?")&&(await g({query:"DELETE FROM loading_ports WHERE id = ?",params:[c.id]})).success&&await E()};return K(()=>{const c=localStorage.getItem("user");c&&(i.value=JSON.parse(c),E())}),(c,d)=>(s(),a("div",Yt,[e("div",Jt,[d[5]||(d[5]=e("h2",null,"Loading Ports Management",-1)),e("button",{onClick:d[0]||(d[0]=n=>$.value=!0),class:"add-btn"},"Add Loading Port")]),e("div",Qt,[e("table",jt,[d[6]||(d[6]=e("thead",null,[e("tr",null,[e("th",null,"Loading Port"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(A.value,n=>(s(),a("tr",{key:n.id},[e("td",null,m(n.loading_port),1),e("td",null,[e("button",{onClick:k=>B(n),class:"btn edit-btn"},"Edit",8,zt),V.value?(s(),a("button",{key:0,onClick:k=>_(n),class:"btn delete-btn"},"Delete",8,Gt)):D("",!0)])]))),128))])])]),$.value?(s(),a("div",Kt,[e("div",Xt,[d[7]||(d[7]=e("h3",null,"Add New Loading Port",-1)),e("div",Zt,[p(e("input",{"onUpdate:modelValue":d[1]||(d[1]=n=>v.value.loading_port=n),placeholder:"Loading Port Name",class:"input-field"},null,512),[[S,v.value.loading_port]])]),e("div",es,[e("button",{onClick:O,class:"btn save-btn"},"Save"),e("button",{onClick:d[2]||(d[2]=n=>$.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0),N.value?(s(),a("div",ls,[e("div",ts,[d[8]||(d[8]=e("h3",null,"Edit Loading Port",-1)),e("div",ss,[p(e("input",{"onUpdate:modelValue":d[3]||(d[3]=n=>f.value.loading_port=n),placeholder:"Loading Port Name",class:"input-field"},null,512),[[S,f.value.loading_port]])]),e("div",as,[e("button",{onClick:w,class:"btn save-btn"},"Save"),e("button",{onClick:d[4]||(d[4]=n=>N.value=!1),class:"btn cancel-btn"},"Cancel")])])])):D("",!0)]))}},ns=H(os,[["__scopeId","data-v-b6aa02ef"]]),is={class:"master-section"},ds={key:0,class:"toolbar"},us={class:"bill-info"},rs={class:"bill-id"},cs={class:"bill-details"},vs={class:"detail-item"},ps={class:"value"},bs={class:"detail-item"},ms={class:"value"},_s={class:"detail-item"},ys={class:"value"},gs={class:"detail-item"},fs={class:"value"},ks={class:"detail-item"},Es={class:"toolbar-actions"},Cs={class:"data-table"},$s=["onClick"],ws={__name:"BuyBillsTable",props:{buyBills:{type:Array,required:!0},selectedBill:{type:Object,default:null}},emits:["select-bill"],setup(I,{emit:A}){const g=N=>N?new Date(N).toLocaleDateString():"N/A",$=N=>{const f=Number(N);return isNaN(f)?"N/A":f.toFixed(2)};return(N,f)=>(s(),a("div",is,[I.selectedBill?(s(),a("div",ds,[e("div",us,[e("div",rs," Purchase #"+m(I.selectedBill.id),1),e("div",cs,[e("div",vs,[f[0]||(f[0]=e("span",{class:"label"},"Supplier:",-1)),e("span",ps,m(I.selectedBill.supplier_name),1)]),e("div",bs,[f[1]||(f[1]=e("span",{class:"label"},"Amount:",-1)),e("span",ms,m($(I.selectedBill.amount)),1)]),e("div",_s,[f[2]||(f[2]=e("span",{class:"label"},"Paid:",-1)),e("span",ys,m($(I.selectedBill.payed)),1)]),e("div",gs,[f[3]||(f[3]=e("span",{class:"label"},"Balance:",-1)),e("span",fs,m($(I.selectedBill.amount-I.selectedBill.payed)),1)]),e("div",ks,[f[4]||(f[4]=e("span",{class:"label"},"Status:",-1)),e("span",{class:F(["value",I.selectedBill.is_stock_updated?"status-updated":"status-pending"])},m(I.selectedBill.is_stock_updated?"Updated":"Pending"),3)])])]),e("div",Es,[ce(N.$slots,"actions",{bill:I.selectedBill},void 0,!0)])])):D("",!0),e("table",Cs,[f[5]||(f[5]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Date"),e("th",null,"Supplier"),e("th",null,"Amount"),e("th",null,"Paid"),e("th",null,"Balance"),e("th",null,"Status")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(I.buyBills,i=>{var V;return s(),a("tr",{key:i.id,class:F({selected:((V=I.selectedBill)==null?void 0:V.id)===i.id}),onClick:v=>N.$emit("select-bill",i)},[e("td",null,m(i.id),1),e("td",null,m(g(i.date_buy)),1),e("td",null,m(i.supplier_name),1),e("td",null,m($(i.amount)),1),e("td",null,m($(i.payed)),1),e("td",null,m($(i.amount-i.payed)),1),e("td",null,[e("span",{class:F(i.is_stock_updated?"status-updated":"status-pending")},m(i.is_stock_updated?"Updated":"Pending"),3)])],10,$s)}),128))])])]))}},Ss=H(ws,[["__scopeId","data-v-2220627e"]]),hs={class:"detail-section"},As={class:"detail-header"},Ds={class:"button-group"},Ns=["disabled","title"],Ts=["disabled","title"],Us={class:"data-table"},Rs={class:"actions"},Vs=["onClick","disabled","title"],Bs=["onClick","disabled","title"],Os={key:0,class:"dialog-overlay"},Ps={class:"dialog"},Ls={class:"form-group"},qs={class:"form-group"},Is={class:"form-row"},Fs={class:"form-group half"},Ms={class:"form-group half"},xs={class:"form-group"},Ws={class:"form-group"},Hs={class:"dialog-buttons"},Ys={__name:"BuyDetailsTable",props:{buyDetails:{type:Array,required:!0},isAdmin:{type:Boolean,default:!1}},emits:["add-detail","delete-detail","update-detail"],setup(I,{emit:A}){const{callApi:g}=z(),$=I,N=A,f=b(!1),i=b(null),V=G(()=>{var w;return((w=$.buyDetails[0])==null?void 0:w.is_stock_updated)===1}),v=(w,_)=>{if(_){alert("Cannot delete details - Stock has already been updated");return}confirm("Are you sure you want to delete this detail?")&&N("delete-detail",w)},E=w=>{i.value={...w},f.value=!0},O=()=>{N("update-detail",i.value),f.value=!1,i.value=null},B=async()=>{if(!$.buyDetails.length){alert("No details to process");return}if(confirm("Are you sure you want to update the stock? This action cannot be undone.")){for(const _ of $.buyDetails)for(let c=0;c<_.QTY;c++){const d=await g({query:`
            INSERT INTO cars_stock 
            (id_buy_details,price_cell)
            VALUES (?,?)
          `,params:[_.id,_.price_sell]});if(!d.success){alert("Error creating stock entry"),console.error("Error creating stock entry:",d.error);return}}const w=await g({query:"UPDATE buy_bill SET is_stock_updated = 1 WHERE id = ?",params:[$.buyDetails[0].id_buy_bill]});w.success?(alert("Stock has been successfully updated"),N("update-detail",$.buyDetails[0])):(console.error("Error updating is_stock_updated flag:",w.error),alert("Error updating stock"))}};return(w,_)=>(s(),a(P,null,[e("div",hs,[e("div",As,[_[8]||(_[8]=e("h3",null,"Purchase Details",-1)),e("div",Ds,[e("button",{onClick:B,class:F(["stock-btn",{disabled:V.value}]),disabled:V.value,title:V.value?"Stock has already been updated":"Update stock"}," Update Stock ",10,Ns),e("button",{onClick:_[0]||(_[0]=c=>w.$emit("add-detail")),class:F(["add-btn",{disabled:V.value}]),disabled:V.value,title:V.value?"Cannot add details - Stock has been updated":"Add new detail"}," Add Detail ",10,Ts)])]),e("table",Us,[_[9]||(_[9]=e("thead",null,[e("tr",null,[e("th",null,"Car"),e("th",null,"Color"),e("th",null,"Quantity"),e("th",null,"Amount"),e("th",null,"Year"),e("th",null,"Month"),e("th",null,"Price Sell"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(I.buyDetails,c=>(s(),a("tr",{key:c.id},[e("td",null,m(c.car_name),1),e("td",null,m(c.color),1),e("td",null,m(c.QTY),1),e("td",null,m(c.amount),1),e("td",null,m(c.year),1),e("td",null,m(c.month),1),e("td",null,m(c.price_sell),1),e("td",Rs,[e("button",{onClick:d=>E(c),class:F(["edit-btn",{disabled:c.is_stock_updated}]),disabled:c.is_stock_updated,title:c.is_stock_updated?"Cannot edit - Stock has been updated":"Edit this detail"}," Edit ",10,Vs),e("button",{onClick:d=>v(c.id,c.is_stock_updated),class:F(["delete-btn",{disabled:c.is_stock_updated}]),disabled:c.is_stock_updated,title:c.is_stock_updated?"Cannot delete - Stock has been updated":"Delete this detail"}," Delete ",10,Bs)])]))),128))])])]),f.value&&i.value?(s(),a("div",Os,[e("div",Ps,[_[17]||(_[17]=e("h3",null,"Edit Purchase Detail",-1)),e("form",{onSubmit:ee(O,["prevent"])},[e("div",Ls,[_[10]||(_[10]=e("label",{for:"edit-qty"},"Quantity",-1)),p(e("input",{type:"number",id:"edit-qty","onUpdate:modelValue":_[1]||(_[1]=c=>i.value.QTY=c),min:"1",required:""},null,512),[[S,i.value.QTY]])]),e("div",qs,[_[11]||(_[11]=e("label",{for:"edit-amount"},"Amount",-1)),p(e("input",{type:"number",id:"edit-amount","onUpdate:modelValue":_[2]||(_[2]=c=>i.value.amount=c),step:"0.01",required:""},null,512),[[S,i.value.amount]])]),e("div",Is,[e("div",Fs,[_[12]||(_[12]=e("label",{for:"edit-year"},"Year",-1)),p(e("input",{type:"number",id:"edit-year","onUpdate:modelValue":_[3]||(_[3]=c=>i.value.year=c),required:""},null,512),[[S,i.value.year]])]),e("div",Ms,[_[13]||(_[13]=e("label",{for:"edit-month"},"Month",-1)),p(e("input",{type:"number",id:"edit-month","onUpdate:modelValue":_[4]||(_[4]=c=>i.value.month=c),min:"1",max:"12",required:""},null,512),[[S,i.value.month]])])]),e("div",xs,[_[14]||(_[14]=e("label",{for:"edit-price-sell"},"Price Sell",-1)),p(e("input",{type:"number",id:"edit-price-sell","onUpdate:modelValue":_[5]||(_[5]=c=>i.value.price_sell=c),step:"0.01",required:""},null,512),[[S,i.value.price_sell]])]),e("div",Ws,[_[15]||(_[15]=e("label",{for:"edit-notes"},"Notes",-1)),p(e("textarea",{id:"edit-notes","onUpdate:modelValue":_[6]||(_[6]=c=>i.value.notes=c),rows:"3"},null,512),[[S,i.value.notes]])]),e("div",Hs,[e("button",{type:"button",onClick:_[7]||(_[7]=c=>f.value=!1),class:"cancel-btn"}," Cancel "),_[16]||(_[16]=e("button",{type:"submit",class:"submit-btn"}," Save Changes ",-1))])],32)])])):D("",!0)],64))}},Js=H(Ys,[["__scopeId","data-v-25287d99"]]),Qs={class:"buy-view"},js={class:"header"},zs={class:"content"},Gs={class:"master-detail-vertical"},Ks=["onClick","disabled"];const Xs=["onClick","disabled"],Zs={key:0,class:"dialog-overlay"},ea={class:"dialog"},la={class:"form-group"},ta=["value"],sa={class:"form-group"},aa={class:"form-group"},oa={class:"form-group"},na={class:"dialog-buttons"},ia={key:1,class:"dialog-overlay"},da={class:"dialog"},ua={class:"form-group"},ra=["value"],ca={class:"form-group"},va=["value"],pa={class:"form-group"},ba={class:"form-group"},ma={class:"form-row"},_a={class:"form-group half"},ya={class:"form-group half"},ga={class:"form-group"},fa={class:"form-group"},ka={class:"form-group checkbox"},Ea={class:"dialog-buttons"},Ca={__name:"BuyView",setup(I){const{callApi:A}=z();oe();const g=b([]),$=b(null),N=b([]),f=b([]),i=b([]),V=b([]),v=b(!1),E=b(!1),O=b(JSON.parse(localStorage.getItem("user"))),B=G(()=>{var T;return((T=O.value)==null?void 0:T.role_id)===1}),w=T=>T.amount>0&&!T.is_stock_updated,_=async T=>{if(confirm("Are you sure you want to update the stock? This action cannot be undone."))try{(await A({query:`
        UPDATE buy_bill 
        SET is_stock_updated = 1 
        WHERE id = ?
      `,params:[T.id]})).success?await h():alert("Failed to update stock")}catch(r){console.error("Error updating stock:",r),alert("Failed to update stock")}},c=async T=>{var r;if(confirm("Are you sure you want to delete this purchase and all its details? This action cannot be undone."))try{if(T.is_stock_updated){alert("Cannot delete a purchase that has already been updated in stock");return}if(!(await A({query:"DELETE FROM buy_payments WHERE id_buy_bill = ?",params:[T.id]})).success)throw new Error("Failed to delete related payments");if(!(await A({query:"DELETE FROM buy_details WHERE id_buy_bill = ?",params:[T.id]})).success)throw new Error("Failed to delete purchase details");if((await A({query:"DELETE FROM buy_bill WHERE id = ? AND is_stock_updated = 0",params:[T.id]})).success)((r=$.value)==null?void 0:r.id)===T.id&&($.value=null,N.value=[]),await h();else throw new Error("Failed to delete purchase")}catch(U){console.error("Error deleting purchase:",U),alert(U.message||"Failed to delete purchase")}},d=b({id_supplier:null,date_buy:new Date().toISOString().slice(0,16),amount:0,payed:0,pi_path:""}),n=b({id_car_name:null,id_color:null,amount:0,notes:"",QTY:1,year:new Date().getFullYear(),month:new Date().getMonth()+1,is_used_car:!1,id_buy_bill:null}),k=async()=>{const T=await A({query:"SELECT * FROM suppliers ORDER BY name ASC",params:[]});T.success&&(f.value=T.data)},R=async()=>{const T=await A({query:`
      INSERT INTO buy_bill (id_supplier, date_buy, payed, pi_path)
      VALUES (?, ?, ?, ?)
    `,params:[d.value.id_supplier,d.value.date_buy,d.value.payed,d.value.pi_path]});T.success?(v.value=!1,await h(),d.value={id_supplier:null,date_buy:new Date().toISOString().slice(0,16),payed:0,pi_path:""}):console.error("Error adding purchase:",T.error)},h=async()=>{const T=await A({query:`
      SELECT 
        bb.*,
        s.name as supplier_name,
        COALESCE((
          SELECT SUM(amount * QTY)
          FROM buy_details
          WHERE id_buy_bill = bb.id
        ), 0) as calculated_amount
      FROM buy_bill bb 
      LEFT JOIN suppliers s ON bb.id_supplier = s.id 
      ORDER BY bb.date_buy DESC
    `,params:[]});T.success&&(g.value=T.data.map(r=>({...r,amount:Number(r.calculated_amount),payed:Number(r.payed)})))},q=async T=>{const r=await A({query:`
      SELECT bd.*, cn.car_name, c.color, bb.is_stock_updated
      FROM buy_details bd
      LEFT JOIN cars_names cn ON bd.id_car_name = cn.id
      LEFT JOIN colors c ON bd.id_color = c.id
      LEFT JOIN buy_bill bb ON bd.id_buy_bill = bb.id
      WHERE bd.id_buy_bill = ?
    `,params:[T]});r.success?N.value=r.data:console.error("Error fetching details:",r.error)},J=T=>{$.value=T,q(T.id)},Q=async()=>{const T=await A({query:"SELECT * FROM cars_names ORDER BY car_name ASC",params:[]});T.success&&(i.value=T.data)},X=async()=>{const T=await A({query:"SELECT * FROM colors ORDER BY color ASC",params:[]});T.success&&(V.value=T.data)},y=async T=>{const r=await A({query:`
      UPDATE buy_bill 
      SET amount = (
        SELECT COALESCE(SUM(amount * QTY), 0)
        FROM buy_details
        WHERE id_buy_bill = ?
      )
      WHERE id = ?
    `,params:[T,T]});r.success||console.error("Error updating bill amount:",r.error)},o=async()=>{const T=await A({query:`
      INSERT INTO buy_details 
      (id_car_name, id_color, amount, notes, QTY, year, month, is_used_car, id_buy_bill, price_sell)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `,params:[n.value.id_car_name,n.value.id_color,n.value.amount,n.value.notes,n.value.QTY,n.value.year,n.value.month,n.value.is_used_car?1:0,$.value.id,n.value.price_sell]});T.success?(await y($.value.id),E.value=!1,await q($.value.id),await h(),n.value={id_car_name:null,id_color:null,amount:0,notes:"",QTY:1,year:new Date().getFullYear(),month:new Date().getMonth()+1,is_used_car:!1,id_buy_bill:null}):console.error("Error adding detail:",T.error)};K(()=>{h(),k(),Q(),X()});const u=async T=>{const r=await A({query:"DELETE FROM buy_details WHERE id = ?",params:[T]});r.success?(await y($.value.id),await q($.value.id),await h()):(alert("Failed to delete detail. Please try again."),console.error("Error deleting detail:",r.error))},x=async T=>{const r=await A({query:`
      UPDATE buy_details 
      SET QTY = ?, amount = ?, year = ?, month = ?, notes = ?, price_sell = ?
      WHERE id = ?
    `,params:[T.QTY,T.amount,T.year,T.month,T.notes,T.price_sell,T.id]});r.success?(await y($.value.id),await q($.value.id),await h()):(alert("Failed to update detail. Please try again."),console.error("Error updating detail:",r.error))},le=T=>{window.open(`/buy-payments/${T.id}`,"_blank")};return(T,r)=>(s(),a("div",Qs,[e("div",js,[r[17]||(r[17]=e("h2",null,"Buy Management",-1)),e("button",{onClick:r[0]||(r[0]=U=>v.value=!0),class:"add-btn"},"Add New Purchase")]),e("div",zs,[e("div",Gs,[ve(Ss,{buyBills:g.value,selectedBill:$.value,onSelectBill:J},{actions:pe(({bill:U})=>[e("button",{onClick:ee(Z=>le(U),["stop"]),class:"payment-btn",disabled:U.is_stock_updated}," Payments ",8,Ks),D("",!0),B.value?(s(),a("button",{key:1,onClick:ee(Z=>c(U),["stop"]),class:"action-btn delete-btn",disabled:U.is_stock_updated}," Delete ",8,Xs)):D("",!0)]),_:1},8,["buyBills","selectedBill"]),$.value?(s(),W(Js,{key:0,buyDetails:N.value,isAdmin:B.value,onAddDetail:r[1]||(r[1]=U=>E.value=!0),onDeleteDetail:u,onUpdateDetail:x},null,8,["buyDetails","isAdmin"])):D("",!0)])]),v.value?(s(),a("div",Zs,[e("div",ea,[r[24]||(r[24]=e("h3",null,"Add New Purchase",-1)),e("form",{onSubmit:ee(R,["prevent"])},[e("div",la,[r[19]||(r[19]=e("label",null,"Supplier",-1)),p(e("select",{"onUpdate:modelValue":r[2]||(r[2]=U=>d.value.id_supplier=U),required:""},[r[18]||(r[18]=e("option",{value:""},"Select Supplier",-1)),(s(!0),a(P,null,L(f.value,U=>(s(),a("option",{key:U.id,value:U.id},m(U.name),9,ta))),128))],512),[[M,d.value.id_supplier]])]),e("div",sa,[r[20]||(r[20]=e("label",null,"Date",-1)),p(e("input",{type:"datetime-local","onUpdate:modelValue":r[3]||(r[3]=U=>d.value.date_buy=U),required:""},null,512),[[S,d.value.date_buy]])]),e("div",aa,[r[21]||(r[21]=e("label",null,"Paid Amount",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=U=>d.value.payed=U),step:"0.01",required:""},null,512),[[S,d.value.payed]])]),e("div",oa,[r[22]||(r[22]=e("label",null,"PI Path",-1)),p(e("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=U=>d.value.pi_path=U)},null,512),[[S,d.value.pi_path]])]),e("div",na,[e("button",{type:"button",onClick:r[6]||(r[6]=U=>v.value=!1),class:"cancel-btn"}," Cancel "),r[23]||(r[23]=e("button",{type:"submit",class:"submit-btn"}," Add Purchase ",-1))])],32)])])):D("",!0),E.value?(s(),a("div",ia,[e("div",da,[r[37]||(r[37]=e("h3",null,"Add Purchase Detail",-1)),e("form",{onSubmit:ee(o,["prevent"])},[e("div",ua,[r[26]||(r[26]=e("label",null,"Car",-1)),p(e("select",{"onUpdate:modelValue":r[7]||(r[7]=U=>n.value.id_car_name=U),required:""},[r[25]||(r[25]=e("option",{value:""},"Select Car",-1)),(s(!0),a(P,null,L(i.value,U=>(s(),a("option",{key:U.id,value:U.id},m(U.car_name),9,ra))),128))],512),[[M,n.value.id_car_name]])]),e("div",ca,[r[28]||(r[28]=e("label",null,"Color",-1)),p(e("select",{"onUpdate:modelValue":r[8]||(r[8]=U=>n.value.id_color=U),required:""},[r[27]||(r[27]=e("option",{value:""},"Select Color",-1)),(s(!0),a(P,null,L(V.value,U=>(s(),a("option",{key:U.id,value:U.id},m(U.color),9,va))),128))],512),[[M,n.value.id_color]])]),e("div",pa,[r[29]||(r[29]=e("label",null,"Quantity",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[9]||(r[9]=U=>n.value.QTY=U),min:"1",required:""},null,512),[[S,n.value.QTY]])]),e("div",ba,[r[30]||(r[30]=e("label",null,"Amount",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[10]||(r[10]=U=>n.value.amount=U),step:"0.01",required:""},null,512),[[S,n.value.amount]])]),e("div",ma,[e("div",_a,[r[31]||(r[31]=e("label",null,"Year",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[11]||(r[11]=U=>n.value.year=U),required:""},null,512),[[S,n.value.year]])]),e("div",ya,[r[32]||(r[32]=e("label",null,"Month",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[12]||(r[12]=U=>n.value.month=U),min:"1",max:"12",required:""},null,512),[[S,n.value.month]])])]),e("div",ga,[r[33]||(r[33]=e("label",null,"Price Sell",-1)),p(e("input",{type:"number","onUpdate:modelValue":r[13]||(r[13]=U=>n.value.price_sell=U),step:"0.01",required:""},null,512),[[S,n.value.price_sell]])]),e("div",fa,[r[34]||(r[34]=e("label",null,"Notes",-1)),p(e("textarea",{"onUpdate:modelValue":r[14]||(r[14]=U=>n.value.notes=U),rows:"3"},null,512),[[S,n.value.notes]])]),e("div",ka,[e("label",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":r[15]||(r[15]=U=>n.value.is_used_car=U)},null,512),[[te,n.value.is_used_car]]),r[35]||(r[35]=Y(" Used Car "))])]),e("div",Ea,[e("button",{type:"button",onClick:r[16]||(r[16]=U=>E.value=!1),class:"cancel-btn"}," Cancel "),r[36]||(r[36]=e("button",{type:"submit",class:"submit-btn"}," Add Detail ",-1))])],32)])])):D("",!0)]))}},$a=H(Ca,[["__scopeId","data-v-17bb8d17"]]),wa={class:"sell-view"},Sa={class:"header"},ha={key:0,class:"selected-bill"},Aa={class:"bill-id"},Da={class:"content"},Na={key:0,class:"loading"},Ta={key:1,class:"error"},Ua={key:2,class:"tables-container"},Ra={class:"sell-bills-table"},Va=["onClick"],Ba=["onClick"],Oa=["onClick"],Pa={key:0,class:"car-stock-table"},La={key:0,class:"loading"},qa={key:1,class:"no-data"},Ia={key:2},Fa=["onClick"],Ma=["onClick"],xa={key:1,class:"available-cars-table"},Wa={key:0,class:"loading"},Ha={key:1,class:"no-data"},Ya={key:2},Ja=["onClick"],Qa={key:1,class:"dialog-overlay"},ja={class:"dialog"},za={class:"form-group"},Ga=["value"],Ka={class:"form-group"},Xa={class:"form-group"},Za=["value"],eo={class:"form-group"},lo=["value"],to={class:"form-group"},so={class:"dialog-buttons"},ao={key:2,class:"dialog-overlay"},oo={class:"dialog"},no={class:"form-group"},io=["value"],uo={class:"form-group"},ro={class:"form-group"},co={class:"dialog-buttons"},vo={key:3,class:"dialog-overlay"},po={class:"dialog"},bo={class:"form-group"},mo=["value"],_o={class:"form-group"},yo={class:"form-group"},go=["value"],fo={class:"form-group"},ko=["value"],Eo={class:"form-group"},Co={class:"form-group"},$o={class:"dialog-buttons"},wo={key:4,class:"dialog-overlay"},So={class:"dialog"},ho={class:"form-group"},Ao=["value"],Do={class:"form-group"},No={class:"form-group"},To=["value"],Uo={class:"form-group"},Ro=["value"],Vo={class:"form-group"},Bo={class:"dialog-buttons"},Oo={key:5,class:"dialog-overlay"},Po={class:"dialog"},Lo={class:"form-group"},qo=["value"],Io={class:"form-group"},Fo={class:"form-group"},Mo={class:"dialog-buttons"},xo={key:6,class:"dialog-overlay"},Wo={class:"dialog"},Ho={class:"form-group"},Yo=["value"],Jo={class:"form-group"},Qo={class:"form-group"},jo={class:"dialog-buttons"},zo={__name:"SellView",setup(I){const{callApi:A}=z(),g=b([]),$=b([]),N=b([]),f=b(!0),i=b(!1),V=b(!1),v=b(null),E=b(null),O=b(!1),B=b(!1),w=b(null),_=b([]),c=b([]),d=b([]),n=b(!1),k=b({id:null,id_broker:null,date_sell:"",notes:""}),R=b(!1),h=b(null),q=b({id_broker:null,date_sell:new Date().toISOString().split("T")[0],notes:""}),J=b([]),Q=async()=>{f.value=!0,v.value=null;try{const C=await A({query:`
        SELECT 
          sb.id,
          sb.date_sell,
          sb.notes,
          c.name as broker_name,
          c.mobiles as broker_mobile
        FROM sell_bill sb
        LEFT JOIN clients c ON sb.id_broker = c.id AND c.is_broker = 1
        ORDER BY sb.date_sell DESC
      `,params:[]});C.success?g.value=C.data:v.value=C.error||"Failed to fetch sell bills"}catch(C){v.value=C.message||"An error occurred"}finally{f.value=!1}},X=async()=>{try{const C=await A({query:`
        SELECT id, name, mobiles
        FROM clients
        WHERE is_broker = 1
        ORDER BY name ASC
      `,params:[]});C.success&&(J.value=C.data)}catch(C){console.error("Error fetching brokers:",C)}},y=async C=>{E.value=C.id,await o(C.id)},o=async C=>{i.value=!0;try{const l=await A({query:`
        SELECT 
          cs.id,
          cs.vin,
          cs.price_cell,
          cs.date_loding,
          cs.date_sell,
          cs.notes,
          cs.freight,
          cs.path_documents,
          cs.sell_pi_path,
          cs.buy_pi_path,
          c.name as client_name,
          cn.car_name,
          clr.color,
          lp.loading_port,
          dp.discharge_port,
          bd.price_sell as buy_price
        FROM cars_stock cs
        LEFT JOIN clients c ON cs.id_client = c.id
        LEFT JOIN buy_details bd ON cs.id_buy_details = bd.id
        LEFT JOIN cars_names cn ON bd.id_car_name = cn.id
        LEFT JOIN colors clr ON bd.id_color = clr.id
        LEFT JOIN loading_ports lp ON cs.id_port_loading = lp.id
        LEFT JOIN discharge_ports dp ON cs.id_port_discharge = dp.id
        WHERE cs.id_sell = ? AND cs.hidden = 0
        ORDER BY cs.id DESC
      `,params:[C]});l.success?$.value=l.data:v.value=l.error||"Failed to fetch cars stock"}catch(l){v.value=l.message||"An error occurred"}finally{i.value=!1}},u=async()=>{V.value=!0;try{const C=await A({query:`
        SELECT 
          cs.id,
          cs.vin,
          cs.price_cell,
          cs.date_loding,
          cs.notes,
          cs.freight,
          c.name as client_name,
          cn.car_name,
          clr.color,
          lp.loading_port,
          dp.discharge_port,
          bd.price_sell as buy_price
        FROM cars_stock cs
        LEFT JOIN clients c ON cs.id_client = c.id
        LEFT JOIN buy_details bd ON cs.id_buy_details = bd.id
        LEFT JOIN cars_names cn ON bd.id_car_name = cn.id
        LEFT JOIN colors clr ON bd.id_color = clr.id
        LEFT JOIN loading_ports lp ON cs.id_port_loading = lp.id
        LEFT JOIN discharge_ports dp ON cs.id_port_discharge = dp.id
        WHERE cs.id_sell IS NULL AND cs.hidden = 0
        ORDER BY cs.id DESC
      `,params:[]});C.success?N.value=C.data:v.value=C.error||"Failed to fetch available cars"}catch(C){v.value=C.message||"An error occurred"}finally{V.value=!1}},x=async()=>{try{const C=await A({query:`
        INSERT INTO sell_bill (id_broker, date_sell, notes)
        VALUES (?, ?, ?)
      `,params:[q.value.id_broker,q.value.date_sell,q.value.notes]});C.success?(O.value=!1,q.value={id_broker:null,date_sell:new Date().toISOString().split("T")[0],notes:""},await Q()):v.value=C.error||"Failed to add sell bill"}catch(C){v.value=C.message||"An error occurred"}},le=async()=>{try{const C=await A({query:"SELECT * FROM loading_ports ORDER BY loading_port ASC",params:[]});C.success&&(_.value=C.data)}catch(C){console.error("Error fetching loading ports:",C)}},T=async()=>{try{const C=await A({query:"SELECT * FROM discharge_ports ORDER BY discharge_port ASC",params:[]});C.success&&(c.value=C.data)}catch(C){console.error("Error fetching discharge ports:",C)}},r=async()=>{try{const C=await A({query:"SELECT * FROM clients WHERE is_broker = 0 ORDER BY name ASC",params:[]});C.success&&(d.value=C.data)}catch(C){console.error("Error fetching clients:",C)}},U=C=>{w.value={...C},B.value=!0},Z=async()=>{if(!E.value){alert("Please select a bill first");return}if(!w.value.id_client){alert("Client name is required");return}if(!w.value.id_port_discharge){alert("Discharge port is required");return}if(!w.value.price_cell){alert("Selling price is required");return}try{const C=await A({query:`
        UPDATE cars_stock 
        SET id_sell = ?,
            id_client = ?,
            vin = ?,
            id_port_loading = ?,
            id_port_discharge = ?,
            price_cell = ?
        WHERE id = ?
      `,params:[E.value,w.value.id_client,w.value.vin,w.value.id_port_loading,w.value.id_port_discharge,w.value.price_cell,w.value.id]});C.success?(B.value=!1,await o(E.value),await u()):v.value=C.error||"Failed to assign car to bill"}catch(C){v.value=C.message||"An error occurred"}},se=async C=>{try{const l=await A({query:`
        UPDATE cars_stock 
        SET id_client = NULL,
            id_port_discharge = NULL,
            id_sell = NULL
        WHERE id = ?
      `,params:[C]});l.success?(await o(E.value),await u()):v.value=l.error||"Failed to unassign car"}catch(l){v.value=l.message||"An error occurred"}},ne=(C,l)=>{l.stopPropagation(),k.value={id:C.id,id_broker:C.id_broker,date_sell:C.date_sell.split("T")[0],notes:C.notes||""},n.value=!0},ie=async()=>{try{const C=await A({query:`
        UPDATE sell_bill 
        SET id_broker = ?, 
            date_sell = ?, 
            notes = ?
        WHERE id = ?
      `,params:[k.value.id_broker,k.value.date_sell,k.value.notes,k.value.id]});C.success?(n.value=!1,await Q(),E.value===k.value.id&&await o(E.value)):v.value=C.error||"Failed to update sell bill"}catch(C){v.value=C.message||"An error occurred"}},de=async(C,l)=>{if(l.stopPropagation(),!!confirm("Are you sure you want to delete this sell bill? This will also unassign all cars from this bill."))try{const t=await A({query:`
        UPDATE cars_stock 
        SET id_sell = NULL 
        WHERE id_sell = ?
      `,params:[C]});if(!t.success){v.value=t.error||"Failed to unassign cars from bill";return}const j=await A({query:`
        DELETE FROM sell_bill 
        WHERE id = ?
      `,params:[C]});j.success?(E.value===C&&(E.value=null,$.value=[]),await Q(),await u()):v.value=j.error||"Failed to delete sell bill"}catch(t){v.value=t.message||"An error occurred"}};K(async()=>{await Q(),await X(),await u(),await le(),await T(),await r()});const ue=C=>{h.value={...C},R.value=!0},re=async()=>{if(h.value)try{const C=await A({query:`
        UPDATE cars_stock 
        SET id_client = ?,
            vin = ?,
            id_port_loading = ?,
            id_port_discharge = ?,
            price_cell = ?,
            notes = ?
        WHERE id = ?
      `,params:[h.value.id_client,h.value.vin,h.value.id_port_loading,h.value.id_port_discharge,h.value.price_cell,h.value.notes,h.value.id]});C.success?(R.value=!1,await o(E.value)):v.value=C.error||"Failed to update car"}catch(C){v.value=C.message||"An error occurred"}};return(C,l)=>(s(),a("div",wa,[e("div",Sa,[l[32]||(l[32]=e("h2",null,"Sell Bills Management",-1)),e("button",{class:"add-btn",onClick:l[0]||(l[0]=t=>O.value=!0)}," Add New Sell Bill ")]),E.value?(s(),a("div",ha,[l[33]||(l[33]=Y(" Selected Bill ID: ")),e("span",Aa,m(E.value),1)])):D("",!0),e("div",Da,[f.value?(s(),a("div",Na,"Loading...")):v.value?(s(),a("div",Ta,m(v.value),1)):(s(),a("div",Ua,[e("div",Ra,[l[35]||(l[35]=e("h3",null,"Sell Bills",-1)),e("table",null,[l[34]||(l[34]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Date"),e("th",null,"Broker"),e("th",null,"Notes"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(g.value,t=>(s(),a("tr",{key:t.id,onClick:j=>y(t),class:F({selected:E.value===t.id})},[e("td",null,m(t.id),1),e("td",null,m(new Date(t.date_sell).toLocaleDateString()),1),e("td",null,m(t.broker_name||"N/A"),1),e("td",null,m(t.notes||"N/A"),1),e("td",null,[e("button",{onClick:j=>ne(t,j),class:"btn edit-btn"},"Edit",8,Ba),e("button",{class:"btn delete-btn",onClick:j=>de(t.id,j)},"Delete",8,Oa)])],10,Va))),128))])])]),E.value?(s(),a("div",Pa,[l[37]||(l[37]=e("h3",null,"Cars in Selected Bill",-1)),i.value?(s(),a("div",La,"Loading cars...")):$.value.length===0?(s(),a("div",qa," No cars found for this sell bill ")):(s(),a("table",Ia,[l[36]||(l[36]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Car"),e("th",null,"Color"),e("th",null,"VIN"),e("th",null,"Client"),e("th",null,"Loading Port"),e("th",null,"Discharge Port"),e("th",null,"Buy Price"),e("th",null,"Sell Price"),e("th",null,"Profit"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L($.value,t=>(s(),a("tr",{key:t.id},[e("td",null,m(t.id),1),e("td",null,m(t.car_name||"N/A"),1),e("td",null,m(t.color||"N/A"),1),e("td",null,m(t.vin||"N/A"),1),e("td",null,m(t.client_name||"N/A"),1),e("td",null,m(t.loading_port||"N/A"),1),e("td",null,m(t.discharge_port||"N/A"),1),e("td",null,"$"+m(t.buy_price||0),1),e("td",null,"$"+m(t.price_cell||0),1),e("td",null,"$"+m(t.price_cell-t.buy_price||0),1),e("td",null,[e("button",{onClick:j=>ue(t),class:"edit-btn"},"Edit",8,Fa),e("button",{onClick:j=>se(t.id),class:"unassign-btn"},"Unassign",8,Ma)])]))),128))])]))])):D("",!0),E.value?(s(),a("div",xa,[l[39]||(l[39]=e("h3",null,"Available Cars",-1)),V.value?(s(),a("div",Wa,"Loading...")):N.value.length===0?(s(),a("div",Ha,"No available cars")):(s(),a("table",Ya,[l[38]||(l[38]=e("thead",null,[e("tr",null,[e("th",null,"Car"),e("th",null,"Color"),e("th",null,"VIN"),e("th",null,"Buy Price"),e("th",null,"Actions")])],-1)),e("tbody",null,[(s(!0),a(P,null,L(N.value,t=>(s(),a("tr",{key:t.id},[e("td",null,m(t.car_name||"N/A"),1),e("td",null,m(t.color||"N/A"),1),e("td",null,m(t.vin||"N/A"),1),e("td",null,"$"+m(t.buy_price||0),1),e("td",null,"$"+m(t.price_cell||0),1),e("td",null,"$"+m(t.price_cell-t.buy_price||0),1),e("td",null,[e("button",{onClick:j=>U(t),class:"assign-btn"},"Assign to Bill",8,Ja)])]))),128))])]))])):D("",!0)]))]),B.value?(s(),a("div",Qa,[e("div",ja,[l[48]||(l[48]=e("h2",null,"Assign Car to Bill",-1)),e("div",za,[l[41]||(l[41]=e("label",{for:"client"},[Y("Client: "),e("span",{class:"required"},"*")],-1)),p(e("select",{id:"client","onUpdate:modelValue":l[1]||(l[1]=t=>w.value.id_client=t),required:""},[l[40]||(l[40]=e("option",{value:""},"Select Client",-1)),(s(!0),a(P,null,L(d.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,Ga))),128))],512),[[M,w.value.id_client]])]),e("div",Ka,[l[42]||(l[42]=e("label",{for:"vin"},"VIN:",-1)),p(e("input",{type:"text",id:"vin","onUpdate:modelValue":l[2]||(l[2]=t=>w.value.vin=t)},null,512),[[S,w.value.vin]])]),e("div",Xa,[l[44]||(l[44]=e("label",{for:"loading-port"},"Loading Port:",-1)),p(e("select",{id:"loading-port","onUpdate:modelValue":l[3]||(l[3]=t=>w.value.id_port_loading=t)},[l[43]||(l[43]=e("option",{value:""},"Select Loading Port",-1)),(s(!0),a(P,null,L(_.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.loading_port),9,Za))),128))],512),[[M,w.value.id_port_loading]])]),e("div",eo,[l[46]||(l[46]=e("label",{for:"discharge-port"},[Y("Discharge Port: "),e("span",{class:"required"},"*")],-1)),p(e("select",{id:"discharge-port","onUpdate:modelValue":l[4]||(l[4]=t=>w.value.id_port_discharge=t),required:""},[l[45]||(l[45]=e("option",{value:""},"Select Discharge Port",-1)),(s(!0),a(P,null,L(c.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.discharge_port),9,lo))),128))],512),[[M,w.value.id_port_discharge]])]),e("div",to,[l[47]||(l[47]=e("label",{for:"sell-price"},[Y("Sell Price: "),e("span",{class:"required"},"*")],-1)),p(e("input",{type:"number",id:"sell-price","onUpdate:modelValue":l[5]||(l[5]=t=>w.value.price_cell=t),required:""},null,512),[[S,w.value.price_cell]])]),e("div",so,[e("button",{onClick:Z,class:"primary"},"Assign"),e("button",{onClick:l[6]||(l[6]=t=>B.value=!1)},"Cancel")])])])):D("",!0),O.value?(s(),a("div",ao,[e("div",oo,[l[53]||(l[53]=e("h3",null,"Add New Sell Bill",-1)),e("div",no,[l[50]||(l[50]=e("label",{for:"broker"},"Broker:",-1)),p(e("select",{id:"broker","onUpdate:modelValue":l[7]||(l[7]=t=>q.value.id_broker=t)},[l[49]||(l[49]=e("option",{value:""},"Select Broker",-1)),(s(!0),a(P,null,L(J.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,io))),128))],512),[[M,q.value.id_broker]])]),e("div",uo,[l[51]||(l[51]=e("label",{for:"date"},"Date:",-1)),p(e("input",{type:"date",id:"date","onUpdate:modelValue":l[8]||(l[8]=t=>q.value.date_sell=t)},null,512),[[S,q.value.date_sell]])]),e("div",ro,[l[52]||(l[52]=e("label",{for:"notes"},"Notes:",-1)),p(e("textarea",{id:"notes","onUpdate:modelValue":l[9]||(l[9]=t=>q.value.notes=t)},null,512),[[S,q.value.notes]])]),e("div",co,[e("button",{onClick:l[10]||(l[10]=t=>O.value=!1)},"Cancel"),e("button",{onClick:x,class:"primary"},"Add")])])])):D("",!0),R.value?(s(),a("div",vo,[e("div",po,[l[63]||(l[63]=e("h3",null,"Edit Car Details",-1)),e("div",bo,[l[55]||(l[55]=e("label",{for:"edit-car-client"},"Client:",-1)),p(e("select",{id:"edit-car-client","onUpdate:modelValue":l[11]||(l[11]=t=>h.value.id_client=t)},[l[54]||(l[54]=e("option",{value:""},"Select Client",-1)),(s(!0),a(P,null,L(d.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,mo))),128))],512),[[M,h.value.id_client]])]),e("div",_o,[l[56]||(l[56]=e("label",{for:"edit-car-vin"},"VIN:",-1)),p(e("input",{type:"text",id:"edit-car-vin","onUpdate:modelValue":l[12]||(l[12]=t=>h.value.vin=t)},null,512),[[S,h.value.vin]])]),e("div",yo,[l[58]||(l[58]=e("label",{for:"edit-car-loading-port"},"Loading Port:",-1)),p(e("select",{id:"edit-car-loading-port","onUpdate:modelValue":l[13]||(l[13]=t=>h.value.id_port_loading=t)},[l[57]||(l[57]=e("option",{value:""},"Select Loading Port",-1)),(s(!0),a(P,null,L(_.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.loading_port),9,go))),128))],512),[[M,h.value.id_port_loading]])]),e("div",fo,[l[60]||(l[60]=e("label",{for:"edit-car-discharge-port"},"Discharge Port:",-1)),p(e("select",{id:"edit-car-discharge-port","onUpdate:modelValue":l[14]||(l[14]=t=>h.value.id_port_discharge=t)},[l[59]||(l[59]=e("option",{value:""},"Select Discharge Port",-1)),(s(!0),a(P,null,L(c.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.discharge_port),9,ko))),128))],512),[[M,h.value.id_port_discharge]])]),e("div",Eo,[l[61]||(l[61]=e("label",{for:"edit-car-price"},"Selling Price:",-1)),p(e("input",{type:"number",id:"edit-car-price","onUpdate:modelValue":l[15]||(l[15]=t=>h.value.price_cell=t)},null,512),[[S,h.value.price_cell]])]),e("div",Co,[l[62]||(l[62]=e("label",{for:"edit-car-notes"},"Notes:",-1)),p(e("textarea",{id:"edit-car-notes","onUpdate:modelValue":l[16]||(l[16]=t=>h.value.notes=t)},null,512),[[S,h.value.notes]])]),e("div",$o,[e("button",{onClick:re,class:"primary"},"Update"),e("button",{onClick:l[17]||(l[17]=t=>R.value=!1)},"Cancel")])])])):D("",!0),B.value?(s(),a("div",wo,[e("div",So,[l[72]||(l[72]=e("h2",null,"Assign Car to Bill",-1)),e("div",ho,[l[65]||(l[65]=e("label",{for:"client"},[Y("Client: "),e("span",{class:"required"},"*")],-1)),p(e("select",{id:"client","onUpdate:modelValue":l[18]||(l[18]=t=>w.value.id_client=t),required:""},[l[64]||(l[64]=e("option",{value:""},"Select Client",-1)),(s(!0),a(P,null,L(d.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,Ao))),128))],512),[[M,w.value.id_client]])]),e("div",Do,[l[66]||(l[66]=e("label",{for:"vin"},"VIN:",-1)),p(e("input",{type:"text",id:"vin","onUpdate:modelValue":l[19]||(l[19]=t=>w.value.vin=t)},null,512),[[S,w.value.vin]])]),e("div",No,[l[68]||(l[68]=e("label",{for:"loading-port"},"Loading Port:",-1)),p(e("select",{id:"loading-port","onUpdate:modelValue":l[20]||(l[20]=t=>w.value.id_port_loading=t)},[l[67]||(l[67]=e("option",{value:""},"Select Loading Port",-1)),(s(!0),a(P,null,L(_.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.loading_port),9,To))),128))],512),[[M,w.value.id_port_loading]])]),e("div",Uo,[l[70]||(l[70]=e("label",{for:"discharge-port"},[Y("Discharge Port: "),e("span",{class:"required"},"*")],-1)),p(e("select",{id:"discharge-port","onUpdate:modelValue":l[21]||(l[21]=t=>w.value.id_port_discharge=t),required:""},[l[69]||(l[69]=e("option",{value:""},"Select Discharge Port",-1)),(s(!0),a(P,null,L(c.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.discharge_port),9,Ro))),128))],512),[[M,w.value.id_port_discharge]])]),e("div",Vo,[l[71]||(l[71]=e("label",{for:"sell-price"},[Y("Sell Price: "),e("span",{class:"required"},"*")],-1)),p(e("input",{type:"number",id:"sell-price","onUpdate:modelValue":l[22]||(l[22]=t=>w.value.price_cell=t),required:""},null,512),[[S,w.value.price_cell]])]),e("div",Bo,[e("button",{onClick:Z,class:"primary"},"Assign"),e("button",{onClick:l[23]||(l[23]=t=>B.value=!1)},"Cancel")])])])):D("",!0),O.value?(s(),a("div",Oo,[e("div",Po,[l[77]||(l[77]=e("h3",null,"Add New Sell Bill",-1)),e("div",Lo,[l[74]||(l[74]=e("label",{for:"broker"},"Broker:",-1)),p(e("select",{id:"broker","onUpdate:modelValue":l[24]||(l[24]=t=>q.value.id_broker=t)},[l[73]||(l[73]=e("option",{value:""},"Select Broker",-1)),(s(!0),a(P,null,L(J.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,qo))),128))],512),[[M,q.value.id_broker]])]),e("div",Io,[l[75]||(l[75]=e("label",{for:"date"},"Date:",-1)),p(e("input",{type:"date",id:"date","onUpdate:modelValue":l[25]||(l[25]=t=>q.value.date_sell=t)},null,512),[[S,q.value.date_sell]])]),e("div",Fo,[l[76]||(l[76]=e("label",{for:"notes"},"Notes:",-1)),p(e("textarea",{id:"notes","onUpdate:modelValue":l[26]||(l[26]=t=>q.value.notes=t)},null,512),[[S,q.value.notes]])]),e("div",Mo,[e("button",{onClick:l[27]||(l[27]=t=>O.value=!1)},"Cancel"),e("button",{onClick:x,class:"primary"},"Add")])])])):D("",!0),n.value?(s(),a("div",xo,[e("div",Wo,[l[82]||(l[82]=e("h3",null,"Edit Sell Bill",-1)),e("div",Ho,[l[79]||(l[79]=e("label",{for:"edit-broker"},"Broker:",-1)),p(e("select",{id:"edit-broker","onUpdate:modelValue":l[28]||(l[28]=t=>k.value.id_broker=t)},[l[78]||(l[78]=e("option",{value:""},"Select Broker",-1)),(s(!0),a(P,null,L(J.value,t=>(s(),a("option",{key:t.id,value:t.id},m(t.name),9,Yo))),128))],512),[[M,k.value.id_broker]])]),e("div",Jo,[l[80]||(l[80]=e("label",{for:"edit-date"},"Date:",-1)),p(e("input",{type:"date",id:"edit-date","onUpdate:modelValue":l[29]||(l[29]=t=>k.value.date_sell=t)},null,512),[[S,k.value.date_sell]])]),e("div",Qo,[l[81]||(l[81]=e("label",{for:"edit-notes"},"Notes:",-1)),p(e("textarea",{id:"edit-notes","onUpdate:modelValue":l[30]||(l[30]=t=>k.value.notes=t)},null,512),[[S,k.value.notes]])]),e("div",jo,[e("button",{onClick:l[31]||(l[31]=t=>n.value=!1)},"Cancel"),e("button",{onClick:ie,class:"primary"},"Update")])])])):D("",!0)]))}},Go=H(zo,[["__scopeId","data-v-a7fbf0a4"]]),Ko={class:"cars-view"},Xo={class:"sidebar"},Zo={class:"sidebar-top"},en={class:"sidebar-bottom"},ln={class:"main-content"},tn={class:"content"},sn={key:0,class:"empty-state"},an={__name:"CarsView",setup(I){const A=oe(),g=b(null),$=f=>{g.value=f},N=()=>{A.push("/")};return(f,i)=>(s(),a("div",Ko,[e("div",Xo,[e("div",Zo,[e("button",{onClick:N,class:"sidebar-btn return-btn"}," Return to Dashboard "),e("button",{onClick:i[0]||(i[0]=V=>$("buy")),class:F([{active:g.value==="buy"},"sidebar-btn buy-btn"])}," Purchases ",2),D("",!0),e("button",{onClick:i[2]||(i[2]=V=>$("sell-bills")),class:F([{active:g.value==="sell-bills"},"sidebar-btn sell-bills-btn"])}," Sells ",2),e("button",{onClick:i[3]||(i[3]=V=>$("stock")),class:F([{active:g.value==="stock"},"sidebar-btn stock-btn"])}," Cars Stock ",2)]),e("div",en,[i[12]||(i[12]=e("div",{class:"sidebar-section-title"},"Settings",-1)),e("button",{onClick:i[4]||(i[4]=V=>$("models")),class:F([{active:g.value==="models"},"sidebar-btn"])}," Car Models ",2),e("button",{onClick:i[5]||(i[5]=V=>$("colors")),class:F([{active:g.value==="colors"},"sidebar-btn"])}," Colors ",2),e("button",{onClick:i[6]||(i[6]=V=>$("discharge-ports")),class:F([{active:g.value==="discharge-ports"},"sidebar-btn"])}," Discharge Ports ",2),e("button",{onClick:i[7]||(i[7]=V=>$("loading-ports")),class:F([{active:g.value==="loading-ports"},"sidebar-btn"])}," Loading Ports ",2),e("button",{onClick:i[8]||(i[8]=V=>$("clients")),class:F([{active:g.value==="clients"},"sidebar-btn"])}," Clients ",2),e("button",{onClick:i[9]||(i[9]=V=>$("brokers")),class:F([{active:g.value==="brokers"},"sidebar-btn"])}," Brokers ",2),e("button",{onClick:i[10]||(i[10]=V=>$("suppliers")),class:F([{active:g.value==="suppliers"},"sidebar-btn"])}," Suppliers ",2),e("button",{onClick:i[11]||(i[11]=V=>$("warehouses")),class:F([{active:g.value==="warehouses"},"sidebar-btn"])}," Warehouses ",2)])]),e("div",ln,[i[13]||(i[13]=e("h1",null,"Cars Management",-1)),e("div",tn,[g.value?D("",!0):(s(),a("div",sn," Please select an option from the sidebar ")),g.value==="buy"?(s(),W($a,{key:1})):D("",!0),g.value==="sell"?(s(),W(Go,{key:2})):D("",!0),g.value==="sell-bills"?(s(),W(me,{key:3})):D("",!0),g.value==="stock"?(s(),W(be,{key:4})):D("",!0),g.value==="models"?(s(),W(vt,{key:5})):D("",!0),g.value==="colors"?(s(),W(Dt,{key:6})):D("",!0),g.value==="discharge-ports"?(s(),W(Ht,{key:7})):D("",!0),g.value==="loading-ports"?(s(),W(ns,{key:8})):D("",!0),g.value==="clients"?(s(),W(Je,{key:9})):D("",!0),g.value==="brokers"?(s(),W(pl,{key:10})):D("",!0),g.value==="suppliers"?(s(),W(Nl,{key:11})):D("",!0),g.value==="warehouses"?(s(),W(_e,{key:12})):D("",!0)])])]))}},rn=H(an,[["__scopeId","data-v-312fd390"]]);export{rn as default};
//# sourceMappingURL=CarsView.e-wYV0u3.js.map
